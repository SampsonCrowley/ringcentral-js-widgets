{"version":3,"sources":["containers/CallsOnholdPage/index.js"],"names":["CallsOnholdContainer","props","getCalls","calls","fromSessionId","call","webphoneSession","isConferenceSession","id","Component","propTypes","PropTypes","arrayOf","object","isRequired","string","func","mapToProps","_","phone","callMonitor","params","baseProps","activeCallsUI","getUIProps","mapToFunctions","webphone","conferenceCall","routerInteraction","getAvatarUrl","getUIFunctions","onMerge","sessionId","callsOnHoldClickMergeTrack","parseMergingSessions","sessionIdToMergeWith","sessions","confId","conferences","Object","keys","confSessionId","push","goBack","mergeSessions","onBackButtonClick","length","go","onAdd","callsOnHoldClickAddTrack","fromNumber","webphoneHangup","callsOnHoldClickHangupTrack","hangup","CallsOnholdPage"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { createSelector } from 'reselect';\nimport { filter } from 'ramda';\n\nimport withPhone from '../../lib/withPhone';\nimport CallsOnholdPanel from '../../components/CallsOnholdPanel';\n\nclass CallsOnholdContainer extends Component {\n  static propTypes = {\n    calls: PropTypes.arrayOf(PropTypes.object).isRequired,\n    fromSessionId: PropTypes.string.isRequired,\n    isConferenceSession: PropTypes.func.isRequired,\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.getCalls = createSelector(\n      () => this.props.calls,\n      () => this.props.fromSessionId,\n      (calls, fromSessionId) => filter(\n        call => (\n          call.webphoneSession\n          && !this.props.isConferenceSession(call.webphoneSession)\n          && call.webphoneSession.id !== fromSessionId\n        ),\n        calls\n      ),\n    );\n  }\n\n  render() {\n    return <CallsOnholdPanel {...this.props} calls={this.getCalls()} />;\n  }\n}\n\nfunction mapToProps(_, {\n  phone,\n  phone: {\n    callMonitor,\n  },\n  params,\n  ...props\n}) {\n  const { fromSessionId } = params;\n  const baseProps = phone.activeCallsUI.getUIProps({\n    ...props,\n  });\n\n  return {\n    ...baseProps,\n    calls: callMonitor.calls,\n    fromSessionId,\n  };\n}\n\nfunction mapToFunctions(_, {\n  params,\n  phone,\n  phone: {\n    webphone,\n    conferenceCall,\n    routerInteraction,\n    callMonitor,\n  },\n  getAvatarUrl,\n  ...props\n}) {\n  const { fromSessionId } = params;\n\n  const baseProps = phone.activeCallsUI.getUIFunctions({\n    params,\n    ...props,\n  });\n\n  return {\n    ...baseProps,\n    async onMerge(sessionId) {\n      // to track user click merge\n      callMonitor.callsOnHoldClickMergeTrack();\n\n      const sessions = await conferenceCall.parseMergingSessions({\n        sessionId,\n        sessionIdToMergeWith: fromSessionId,\n      });\n      if (sessions) {\n        const confId = conferenceCall.conferences && Object.keys(conferenceCall.conferences)[0];\n        if (confId) {\n          const confSessionId = conferenceCall.conferences[confId].sessionId;\n          routerInteraction.push(`/calls/active/${confSessionId}`);\n        } else {\n          routerInteraction.goBack();\n        }\n        await conferenceCall.mergeSessions(sessions);\n      }\n    },\n    onBackButtonClick() {\n      if (webphone.sessions.length) {\n        routerInteraction.goBack();\n        return;\n      }\n      phone.routerInteraction.go(-2);\n    },\n    onAdd() {\n      // to track use click add button\n      callMonitor.callsOnHoldClickAddTrack();\n      routerInteraction.push(`/conferenceCall/dialer/${params.fromNumber}/${params.fromSessionId}`);\n    },\n    getAvatarUrl,\n    isConferenceSession: (...args) => conferenceCall.isConferenceSession(...args),\n    async webphoneHangup(...args) {\n      // track user click hangup on calls onhold page\n      callMonitor.callsOnHoldClickHangupTrack();\n      return (webphone && webphone.hangup(...args));\n    },\n  };\n}\n\nconst CallsOnholdPage = withPhone(connect(\n  mapToProps,\n  mapToFunctions,\n)(CallsOnholdContainer));\n\nexport default CallsOnholdPage;\n"],"file":"index.js"}