{"version":3,"sources":["modules/Conversations/getReducer.js"],"names":["getSearchInputReducer","getTypeFilterReducer","getOldConversationsReducer","getFetchConversationsStatusReducer","getCurrentPageReducer","getCurrentConversationIdReducer","getOldMessagesReducer","getFetchMessagesStatusReducer","getMessageTextsReducer","getConversationStatusReducer","getCorrespondentMatch","getReducer","types","state","type","input","updateSearchInput","resetSuccess","messageTypes","all","typeFilter","updateTypeFilter","records","conversationId","fetchOldConverstaionsSuccess","concat","map","normalizeRecord","deleteConversation","filter","c","cleanOldConversatioans","initSuccess","status","idle","fetchOldConverstaions","fetching","fetchOldConverstaionsError","increaseCurrentPage","resetCurrentPage","updateCurrentConversationId","fetchOldMessagesSuccess","fetchOldMessages","fetchOldMessagesError","text","updateMessageText","msg","removeMessageText","reply","pushing","replySuccess","replyError","entitys","entity","addEntity","newState","removeEntity","filteredState","item","rawId","id","searchInput","oldConversations","currentPage","fetchConversationsStatus","currentConversationId","oldMessages","fetchMessagesStatus","messageTexts","conversationStatus","correspondentMatch"],"mappings":"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","file":"getReducer.js","sourcesContent":["import { combineReducers } from 'redux';\nimport getModuleStatusReducer from '../../lib/getModuleStatusReducer';\n\nimport messageTypes from '../../enums/messageTypes';\nimport { normalizeRecord } from '../../lib/messageHelper';\nimport status from './status';\n\nexport function getSearchInputReducer(types) {\n  return (state = '', { type, input = '' }) => {\n    switch (type) {\n      case types.updateSearchInput:\n        return input;\n      case types.resetSuccess:\n        return '';\n      default:\n        return state;\n    }\n  };\n}\n\nexport function getTypeFilterReducer(types) {\n  return (state = messageTypes.all, { type, typeFilter }) => {\n    switch (type) {\n      case types.updateTypeFilter:\n        return typeFilter;\n      case types.resetSuccess:\n        return messageTypes.all;\n      default:\n        return state;\n    }\n  };\n}\n\nexport function getOldConversationsReducer(types) {\n  return (state = [], { type, records, conversationId }) => {\n    switch (type) {\n      case types.fetchOldConverstaionsSuccess:\n        return [].concat(state).concat(records.map(normalizeRecord));\n      case types.deleteConversation:\n        return state.filter(c => c.conversationId !== conversationId);\n      case types.cleanOldConversatioans:\n      case types.resetSuccess:\n      case types.updateTypeFilter:\n      case types.initSuccess:\n        return [];\n      default:\n        return state;\n    }\n  };\n}\n\nexport function getFetchConversationsStatusReducer(types) {\n  return (state = status.idle, { type }) => {\n    switch (type) {\n      case types.fetchOldConverstaions:\n        return status.fetching;\n      case types.fetchOldConverstaionsSuccess:\n      case types.fetchOldConverstaionsError:\n      case types.resetSuccess:\n      case types.updateTypeFilter:\n      case types.initSuccess:\n        return status.idle;\n      default:\n        return state;\n    }\n  };\n}\n\nexport function getCurrentPageReducer(types) {\n  return (state = 1, { type }) => {\n    switch (type) {\n      case types.increaseCurrentPage:\n      case types.fetchOldConverstaionsSuccess:\n        return state + 1;\n      case types.updateTypeFilter:\n      case types.resetSuccess:\n      case types.initSuccess:\n      case types.resetCurrentPage:\n        return 1;\n      default:\n        return state;\n    }\n  };\n}\n\nexport function getCurrentConversationIdReducer(types) {\n  return (state = null, { type, conversationId }) => {\n    switch (type) {\n      case types.updateCurrentConversationId:\n        return conversationId;\n      case types.initSuccess:\n      case types.resetSuccess:\n        return null;\n      default:\n        return state;\n    }\n  };\n}\n\nexport function getOldMessagesReducer(types) {\n  return (state = [], { type, records }) => {\n    switch (type) {\n      case types.fetchOldMessagesSuccess:\n        return [].concat(state).concat(records.map(normalizeRecord));\n      case types.updateCurrentConversationId:\n      case types.resetSuccess:\n      case types.initSuccess:\n        return [];\n      default:\n        return state;\n    }\n  };\n}\n\nexport function getFetchMessagesStatusReducer(types) {\n  return (state = status.idle, { type }) => {\n    switch (type) {\n      case types.fetchOldMessages:\n        return status.fetching;\n      case types.fetchOldMessagesSuccess:\n      case types.fetchOldMessagesError:\n      case types.updateCurrentConversationId:\n      case types.resetSuccess:\n      case types.initSuccess:\n        return status.idle;\n      default:\n        return state;\n    }\n  };\n}\n\nexport function getMessageTextsReducer(types) {\n  return (state = [], { type, text, conversationId }) => {\n    switch (type) {\n      case types.updateMessageText:\n        return [{ conversationId, text }].concat(\n          state.filter(msg => typeof msg === 'object' && msg.conversationId !== conversationId),\n        );\n      case types.removeMessageText:\n        return state.filter(msg => typeof msg === 'object' && msg.conversationId !== conversationId);\n      case types.resetSuccess:\n        return [];\n      default:\n        return state;\n    }\n  };\n}\n\nexport function getConversationStatusReducer(types) {\n  return (state = status.idle, { type }) => {\n    switch (type) {\n      case types.reply:\n        return status.pushing;\n      case types.replySuccess:\n      case types.replyError:\n        return status.idle;\n      default:\n        return state;\n    }\n  };\n}\nexport function getCorrespondentMatch(types) {\n  return (state = [], {\n    type,\n    entitys = [],\n    entity = {}\n  }) => {\n    switch (type) {\n      case types.addEntity: {\n        const newState = [...entitys];\n        return newState;\n      }\n      case types.removeEntity: {\n        const newState = [...state];\n        const filteredState = newState.filter(item =>\n          (item.rawId !== entity.id && item.id !== entity.id));\n        return filteredState;\n      }\n      default:\n        return state;\n    }\n  };\n}\n\nexport default function getReducer(types) {\n  return combineReducers({\n    status: getModuleStatusReducer(types),\n    searchInput: getSearchInputReducer(types),\n    typeFilter: getTypeFilterReducer(types),\n    oldConversations: getOldConversationsReducer(types),\n    currentPage: getCurrentPageReducer(types),\n    fetchConversationsStatus: getFetchConversationsStatusReducer(types),\n    currentConversationId: getCurrentConversationIdReducer(types),\n    oldMessages: getOldMessagesReducer(types),\n    fetchMessagesStatus: getFetchMessagesStatusReducer(types),\n    messageTexts: getMessageTextsReducer(types),\n    conversationStatus: getConversationStatusReducer(types),\n    correspondentMatch: getCorrespondentMatch(types)\n  });\n}\n"]}