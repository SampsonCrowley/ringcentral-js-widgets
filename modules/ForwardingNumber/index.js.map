{"version":3,"sources":["modules/ForwardingNumber/index.js"],"names":["ForwardingNumber","deps","dep","optional","client","rolesAndPermissions","options","fetchFunction","params","_client","account","extension","forwardingNumber","list","lists","map","number","forbiddenHandler","readyCheckFn","_rolesAndPermissions","ready","cleanOnReset","ensureExist","permissions","ReadUserForwardingFlipNumbers","DataFetcher","selector","data","numbers","phoneNumbers","filter","p","features","indexOf","phoneNumber"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAaqBA,gB;AAXrB;;;;OAIC,gBAAO;AACNC,EAAAA,IAAI,EAAE,CACJ,QADI,EAEJ,qBAFI,EAGJ;AAAEC,IAAAA,GAAG,EAAE,yBAAP;AAAkCC,IAAAA,QAAQ,EAAE;AAA5C,GAHI;AADA,CAAP,C;;;;;AAQC;;;;;AAKA,kCAIG;AAAA;;AAAA;;AAAA,QAHDC,MAGC,QAHDA,MAGC;AAAA,QAFDC,mBAEC,QAFDA,mBAEC;AAAA,QADEC,OACF;;AAAA;;AACD;AACEF,MAAAA,MAAM,EAANA,MADF;AAEEG,MAAAA,aAAa;AAAA;AAAA;AAAA,gCAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBACO,2BAAU,UAAAC,MAAM;AAAA,2BAClC,MAAKC,OAAL,CAAaC,OAAb,GAAuBC,SAAvB,GAAmCC,gBAAnC,GAAsDC,IAAtD,CAA2DL,MAA3D,CADkC;AAAA,mBAAhB,CADP;;AAAA;AACPM,kBAAAA,KADO;AAAA,mDAINA,KAAK,CAACC,GAAN,CAAU,UAAAC,MAAM;AAAA,2BAAI,2BAAUA,MAAV,CAAJ;AAAA,mBAAhB,CAJM;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,SAFf;AAQEC,MAAAA,gBAAgB,EAAE;AAAA,eAAM,EAAN;AAAA,OARpB;AASEC,MAAAA,YAAY,EAAE;AAAA,eAAM,MAAKC,oBAAL,CAA0BC,KAAhC;AAAA,OAThB;AAUEC,MAAAA,YAAY,EAAE;AAVhB,OAWKf,OAXL;;AADC;;AAAA;;AAAA;;AAcD,UAAKa,oBAAL,GAA4B,4CAAMG,uBAAN,kBAAkBjB,mBAAlB,EAAuC,qBAAvC,CAA5B;AAdC;AAeF;;;;wBAEW;AACV,aAAO,kBAAP;AACD;;;wBAsBoB;AACnB,aAAO,CAAC,CAAC,KAAKc,oBAAL,CAA0BI,WAA1B,CAAsCC,6BAA/C;AACD;;;;EArD2CC,wB,mFA+B3CC,kB;;;;;;;WACS,CACR;AAAA,aAAM,MAAI,CAACC,IAAX;AAAA,KADQ,EAER,UAAAA,IAAI;AAAA,aAAIA,IAAI,IAAI,EAAZ;AAAA,KAFI,C;;gFAKTD,kB;;;;;;;WACa,CACZ;AAAA,aAAM,MAAI,CAACE,OAAX;AAAA,KADY,EAEZ,UAAAC,YAAY;AAAA,aACVA,YAAY,CAACC,MAAb,CAAoB,UAAAC,CAAC;AAAA,eAAIA,CAAC,CAACC,QAAF,CAAWC,OAAX,CAAmB,UAAnB,MAAmC,CAAC,CAApC,IAAyCF,CAAC,CAACG,WAA/C;AAAA,OAArB,CADU;AAAA,KAFA,C;;sFAMbR,kB;;;;;;;WACmB,CAClB;AAAA,aAAM,MAAI,CAACE,OAAX;AAAA,KADkB,EAElB,UAAAC,YAAY;AAAA,aACVA,YAAY,CAACC,MAAb,CAAoB,UAAAC,CAAC;AAAA,eAAIA,CAAC,CAACC,QAAF,CAAWC,OAAX,CAAmB,gBAAnB,MAAyC,CAAC,CAA1C,IAA+CF,CAAC,CAACG,WAArD;AAAA,OAArB,CADU;AAAA,KAFM,C","sourcesContent":["import { Module } from '../../lib/di';\nimport DataFetcher from '../../lib/DataFetcher';\nimport fetchList from '../../lib/fetchList';\nimport ensureExist from '../../lib/ensureExist';\nimport { selector } from '../../lib/selector';\nimport removeUri from '../../lib/removeUri';\n\n/**\n * @class\n * @description Extension forwarding number list module\n */\n@Module({\n  deps: [\n    'Client',\n    'RolesAndPermissions',\n    { dep: 'ForwardingNumberOptions', optional: true }\n  ]\n})\nexport default class ForwardingNumber extends DataFetcher {\n  /**\n   * @constructor\n   * @param {Object} params - params object\n   * @param {Client} params.client - client module instance\n   */\n  constructor({\n    client,\n    rolesAndPermissions,\n    ...options\n  }) {\n    super({\n      client,\n      fetchFunction: async () => {\n        const lists = await fetchList(params => (\n          this._client.account().extension().forwardingNumber().list(params)\n        ));\n        return lists.map(number => removeUri(number));\n      },\n      forbiddenHandler: () => [],\n      readyCheckFn: () => this._rolesAndPermissions.ready,\n      cleanOnReset: true,\n      ...options,\n    });\n    this._rolesAndPermissions = this::ensureExist(rolesAndPermissions, 'rolesAndPermissions');\n  }\n\n  get _name() {\n    return 'forwardingNumber';\n  }\n\n  @selector\n  numbers = [\n    () => this.data,\n    data => data || [],\n  ]\n\n  @selector\n  flipNumbers = [\n    () => this.numbers,\n    phoneNumbers =>\n      phoneNumbers.filter(p => p.features.indexOf('CallFlip') !== -1 && p.phoneNumber)\n  ]\n\n  @selector\n  forwardingNumbers = [\n    () => this.numbers,\n    phoneNumbers =>\n      phoneNumbers.filter(p => p.features.indexOf('CallForwarding') !== -1 && p.phoneNumber)\n  ]\n\n  get _hasPermission() {\n    return !!this._rolesAndPermissions.permissions.ReadUserForwardingFlipNumbers;\n  }\n}\n"],"file":"index.js"}