{"version":3,"sources":["components/LogSection/index.js"],"names":["EditSection","children","scrollerRef","rest","styles","editSection","propTypes","PropTypes","object","func","defaultProps","undefined","SaveButton","isSaving","onClick","overlapped","buttonPanel","primaryButton","disabled","bool","string","LogSection","props","state","mainCtrlOverlapped","window","addEventListener","checkOverlap","removeEventListener","mainCtrl","scrollHeight","clientHeight","scrollTop","overlappedHeight","setState","renderEditLogSection","currentLocale","onSaveCallLog","onUpdateCallLog","currentLog","additionalInfo","showSaveLogBtn","renderSaveLogButton","call","currentLogCall","i18n","getString","showSmallCallControl","currentSessionId","telephonyStatus","result","status","isActive","clickable","extraButton","renderSmallCallContrl","formatPhone","onLogBasicInfoClick","console","log","isInnerMask","showSpinner","spinner","root","renderLogBasicInfo","el","getEditLogSection","genSaveLogButton","innerMask","Component","isRequired"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport telephonyStatuses from 'ringcentral-integration/enums/telephonyStatus';\nimport callDirections from 'ringcentral-integration/enums/callDirections';\nimport { isRingingInboundCall } from 'ringcentral-integration/lib/callLogHelpers';\n\nimport SpinnerOverlay from '../SpinnerOverlay';\nimport Button from '../Button';\nimport styles from './styles.scss';\nimport LogBasicInfo from '../LogBasicInfo';\nimport i18n from './i18n';\n\nconst EditSection = ({ children, scrollerRef, ...rest }) => (\n  <div\n    {...rest}\n    ref={scrollerRef}\n    className={classnames(\n      styles.editSection\n    )}>\n    {children}\n  </div>\n);\n\nEditSection.propTypes = {\n  children: PropTypes.object,\n  scrollerRef: PropTypes.func,\n};\n\nEditSection.defaultProps = {\n  children: null,\n  scrollerRef: undefined,\n};\n\nconst SaveButton = ({\n  isSaving, onClick, overlapped, children\n}) => (\n  <div className={classnames(\n    styles.buttonPanel,\n    overlapped && styles.overlapped\n  )}>\n    <Button\n      className={classnames(\n        styles.primaryButton,\n        isSaving && styles.disabled\n      )}\n      disabled={isSaving}\n      onClick={onClick}>\n      {children}\n    </Button>\n  </div>\n);\n\nSaveButton.propTypes = {\n  isSaving: PropTypes.bool,\n  onClick: PropTypes.func,\n  overlapped: PropTypes.bool,\n  children: PropTypes.string\n};\n\nSaveButton.defaultProps = {\n  isSaving: false,\n  onClick() {},\n  overlapped: false,\n  children: null\n};\n\nexport default class LogSection extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      mainCtrlOverlapped: false\n    };\n  }\n\n  componentDidMount() {\n    window.addEventListener('resize', this.checkOverlap, false);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.checkOverlap, false);\n  }\n\n  checkOverlap() {\n    if (!this.mainCtrl) {\n      return;\n    }\n    const {\n      scrollHeight,\n      clientHeight,\n      scrollTop\n    } = this.mainCtrl;\n    const overlappedHeight = scrollHeight - clientHeight - scrollTop;\n    const mainCtrlOverlapped = overlappedHeight > 1;\n    if (mainCtrlOverlapped !== this.state.mainCtrlOverlapped) {\n      this.setState({ mainCtrlOverlapped });\n    }\n  }\n\n  getEditLogSection() {\n    const {\n      renderEditLogSection, currentLocale,\n      onSaveCallLog, onUpdateCallLog,\n      currentLog, additionalInfo\n    } = this.props;\n    return renderEditLogSection({\n      currentLocale,\n      onSaveCallLog,\n      onUpdateCallLog,\n      currentLog,\n      additionalInfo,\n    });\n  }\n\n  genSaveLogButton() {\n    const {\n      showSaveLogBtn, renderSaveLogButton,\n      currentLocale, onSaveCallLog,\n      currentLog\n    } = this.props;\n    const {\n      call,\n      currentLogCall,\n    } = currentLog;\n    if (!showSaveLogBtn) {\n      return null;\n    }\n    if (renderSaveLogButton) {\n      return renderSaveLogButton({\n        currentLocale,\n        onSaveCallLog,\n        currentLog,\n        overlapped: this.state.mainCtrlOverlapped\n      });\n    }\n    return (\n      <SaveButton\n        isSaving={currentLogCall.isSaving}\n        onClick={() => onSaveCallLog(call)}\n        overlapped={this.state.mainCtrlOverlapped}\n      >\n        {i18n.getString('saveLog', currentLocale)}\n      </SaveButton>\n    );\n  }\n\n  renderLogBasicInfo() {\n    const { currentLog, showSmallCallControl } = this.props;\n    const { currentSessionId, call } = currentLog;\n    const { telephonyStatus, result } = call;\n    const status = telephonyStatus || result;\n    // if `result` is exist, call has been disconnect\n    const isActive = !result;\n    const clickable = isActive && !isRingingInboundCall(call);\n    let extraButton;\n    if (showSmallCallControl && isActive) {\n      extraButton = this.props.renderSmallCallContrl(status, currentSessionId);\n    }\n    return (\n      <LogBasicInfo\n        dataSign=\"leftSectionInfo\"\n        currentLog={this.props.currentLog}\n        currentLocale={this.props.currentLocale}\n        formatPhone={this.props.formatPhone}\n        extraButton={extraButton}\n        clickable={clickable}\n        onClick={clickable ? this.props.onLogBasicInfoClick : () => console.log('noop')}\n      />\n    );\n  }\n\n  render() {\n    const {\n      currentLog,\n      isInnerMask,\n      // onCloseLogSection\n    } = this.props;\n    const {\n      showSpinner,\n    } = currentLog;\n    if (showSpinner) {\n      return <SpinnerOverlay className={styles.spinner} />;\n    }\n    return (\n      <div className={styles.root}>\n        {this.renderLogBasicInfo()}\n        <EditSection\n          scrollerRef={(el) => { this.mainCtrl = el; }}\n          onScroll={() => this.checkOverlap()}\n        >\n          {this.getEditLogSection()}\n        </EditSection>\n        {this.genSaveLogButton()}\n        {\n          isInnerMask ? (\n            <div className={styles.innerMask} />\n          ) : null\n        }\n      </div>\n    );\n  }\n}\n\nLogSection.propTypes = {\n  currentLog: PropTypes.object,\n  additionalInfo: PropTypes.object,\n  currentLocale: PropTypes.string.isRequired,\n  formatPhone: PropTypes.func,\n  onUpdateCallLog: PropTypes.func,\n  onSaveCallLog: PropTypes.func,\n  renderEditLogSection: PropTypes.func,\n  renderSaveLogButton: PropTypes.func,\n  isInnerMask: PropTypes.bool,\n  onLogBasicInfoClick: PropTypes.func,\n  showSaveLogBtn: PropTypes.bool,\n  showSmallCallControl: PropTypes.bool,\n  renderSmallCallContrl: PropTypes.func,\n};\n\nLogSection.defaultProps = {\n  currentLog: {},\n  additionalInfo: undefined,\n  formatPhone: undefined,\n  onUpdateCallLog: undefined,\n  onSaveCallLog: undefined,\n  renderEditLogSection: undefined,\n  renderSaveLogButton: undefined,\n  isInnerMask: undefined,\n  onLogBasicInfoClick() { },\n  renderSmallCallContrl() { },\n  showSaveLogBtn: true,\n  showSmallCallControl: true,\n};\n"],"file":"index.js"}