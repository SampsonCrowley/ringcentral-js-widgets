{"version":3,"sources":["modules/ConferenceDialerUI/index.js"],"names":["ConferenceDialerUI","name","deps","conferenceCall","routerInteraction","backURL","options","_conferenceCall","_routerInteraction","_backURL","_reducer","actionTypes","sessionId","lastSessionId","clearRecipient","clearToNumberField","store","dispatch","type","setLastSessionId","fromSessionId","mergingPair","setMergeParty","showFromField","params","fromNumber","onBack","push","onCallButtonClick","inConference","Enum","state","DialerUI","proxify"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAMqBA,kB,WAJpB,gBAAO;AACNC,QAAM,oBADA;AAENC,QAAM,CAAC,gBAAD,EAAmB,mBAAnB;AAFA,CAAP,C;;;AAKC,oCAKG;AAAA,QAJDC,cAIC,QAJDA,cAIC;AAAA,QAHDC,iBAGC,QAHDA,iBAGC;AAAA,4BAFDC,OAEC;AAAA,QAFDA,OAEC,gCAFS,eAET;AAAA,QADEC,OACF;AAAA;;AAAA,yLAEIA,OAFJ;;AAID,UAAKC,eAAL,GAAuBJ,cAAvB;AACA,UAAKK,kBAAL,GAA0BJ,iBAA1B;AACA,UAAKK,QAAL,GAAgBJ,OAAhB;AACA,UAAKK,QAAL,GAAgB,0BAAW,MAAKC,WAAhB,CAAhB;AAPC;AAQF;;;;;4GAUsBC,S;;;;;AACrB,oBAAI,KAAKC,aAAL,KAAuBD,SAA3B,EAAsC;AACpC,uBAAKE,cAAL;AACA,uBAAKC,kBAAL;AACD;AACD,qBAAKC,KAAL,CAAWC,QAAX,CAAoB;AAClBC,wBAAM,KAAKP,WAAL,CAAiBQ,gBADL;AAElBP;AAFkB,iBAApB;;;;;;;;;;;;;;;;;;kCAUYQ,a,EAAe;AAC3B,UACEA,iBACA,KAAKb,eAAL,CAAqBc,WADrB,IAEA,CAAC,KAAKd,eAAL,CAAqBc,WAArB,CAAiCD,aAHpC,EAIE;AACA;AACA,aAAKb,eAAL,CAAqBe,aAArB,CAAmC;AACjCF;AADiC,SAAnC;AAGD;AACF;;;iCAEY;AACX;AAEEG,uBAAe;AAFjB;AAID;;;0CAIE;AAAA;;AAAA,+BADDC,MACC;AAAA,UADSC,UACT,gBADSA,UACT;AAAA,UADqBL,aACrB,gBADqBA,aACrB;;AACD;AAEEM,gBAAQ;AAAA,iBAAM,OAAKlB,kBAAL,CAAwBmB,IAAxB,CAA6B,OAAKlB,QAAlC,CAAN;AAAA,SAFV;AAGEU,0BAAkB;AAAA,iBAAM,OAAKA,gBAAL,CAAsBC,aAAtB,CAAN;AAAA,SAHpB;AAIEQ,2BAAmB;AAAA,iBACjB,OAAKA,iBAAL,CAAuB;AACrBH,kCADqB;AAErBL;AAFqB,WAAvB,CADiB;AAAA,SAJrB;AASES,sBAAc;AAThB;AAWD;;;wBAzDkB;AACjB,aAAO,IAAIC,cAAJ,4CACF,oKADE,IAEL,kBAFK,IAGJ,oBAHI,CAAP;AAID;;;wBAcmB;AAClB,aAAO,KAAKC,KAAL,CAAWlB,aAAlB;AACD;;;EArC6CmB,kB,sEAuB7CC,iB;kBAvBkBjC,kB","file":"index.js","sourcesContent":["import { Module } from 'ringcentral-integration/lib/di';\nimport proxify from 'ringcentral-integration/lib/proxy/proxify';\nimport Enum from 'ringcentral-integration/lib/Enum';\n\nimport DialerUI from '../DialerUI';\nimport getReducer from './getReducer';\n\n@Module({\n  name: 'ConferenceDialerUI',\n  deps: ['ConferenceCall', 'RouterInteraction'],\n})\nexport default class ConferenceDialerUI extends DialerUI {\n  constructor({\n    conferenceCall,\n    routerInteraction,\n    backURL = '/calls/active',\n    ...options\n  }) {\n    super({\n      ...options,\n    });\n    this._conferenceCall = conferenceCall;\n    this._routerInteraction = routerInteraction;\n    this._backURL = backURL;\n    this._reducer = getReducer(this.actionTypes);\n  }\n\n  get _actionTypes() {\n    return new Enum([\n      ...Object.keys(super._actionTypes),\n      'setLastSessionId',\n    ], 'conferenceDialerUI');\n  }\n\n  @proxify\n  async setLastSessionId(sessionId) {\n    if (this.lastSessionId !== sessionId) {\n      this.clearRecipient();\n      this.clearToNumberField();\n    }\n    this.store.dispatch({\n      type: this.actionTypes.setLastSessionId,\n      sessionId,\n    });\n  }\n\n  get lastSessionId() {\n    return this.state.lastSessionId;\n  }\n\n  _onBeforeCall(fromSessionId) {\n    if (\n      fromSessionId &&\n      this._conferenceCall.mergingPair &&\n      !this._conferenceCall.mergingPair.fromSessionId\n    ) {\n      // set mergingPair if has\n      this._conferenceCall.setMergeParty({\n        fromSessionId,\n      });\n    }\n  }\n\n  getUIProps() {\n    return {\n      ...super.getUIProps(),\n      showFromField: false,\n    };\n  }\n\n  getUIFunctions({\n    params: { fromNumber, fromSessionId },\n  }) {\n    return {\n      ...super.getUIFunctions(),\n      onBack: () => this._routerInteraction.push(this._backURL),\n      setLastSessionId: () => this.setLastSessionId(fromSessionId),\n      onCallButtonClick: () =>\n        this.onCallButtonClick({\n          fromNumber,\n          fromSessionId,\n        }),\n      inConference: true,\n    };\n  }\n}\n"]}