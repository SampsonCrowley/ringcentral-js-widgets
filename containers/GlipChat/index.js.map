{"version":3,"sources":["containers/GlipChat/index.js"],"names":["getAtRender","glipGroups","glipPersons","onViewPersonProfile","onViewGroup","AtRender","id","type","name","group","allGroups","find","g","person","personsMap","firstName","lastName","onClickAtLink","e","preventDefault","propTypes","PropTypes","number","isRequired","string","mapToProps","_","params","phone","glipPosts","groupId","currentGroup","posts","currentGroupPosts","textValue","postInputs","text","mapToFunctions","dateTimeFormat","dateTimeFormatter","formatDateTime","utcTimestamp","time","mobile","loadGroup","updateCurrentGroupId","loadNextPage","currentGroupId","createPost","create","updateText","mentions","updatePostInput","uploadFile","fileName","rawFile","sendFile","atRender","viewProfile","personId","GlipChatPage","GlipChatPanel"],"mappings":"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","file":"index.js","sourcesContent":["import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport withPhone from 'ringcentral-widgets/lib/withPhone';\n\nimport GlipChatPanel from '../../components/GlipChatPanel';\n\nfunction getAtRender({\n  glipGroups, glipPersons, onViewPersonProfile, onViewGroup\n}) {\n  const AtRender = ({ id, type }) => {\n    let name = id;\n    if (type === 'Team') {\n      const group = glipGroups.allGroups.find(g => g.id === id);\n      name = group && group.name;\n    } else {\n      const person = glipPersons.personsMap[id];\n      name = (\n        person &&\n        `${person.firstName}${person.lastName ? ` ${person.lastName}` : ''}`\n      ) || id;\n    }\n    const onClickAtLink = (e) => {\n      e.preventDefault();\n      if (type === 'Person') {\n        onViewPersonProfile(id);\n      } else if (type === 'Team') {\n        onViewGroup(id);\n      }\n    };\n    return (\n      <a href={`#${id}`} onClick={onClickAtLink}>@{name}</a>\n    );\n  };\n  AtRender.propTypes = {\n    id: PropTypes.number.isRequired,\n    type: PropTypes.string.isRequired,\n  };\n  return AtRender;\n}\n\nfunction mapToProps(_, {\n  params,\n  phone: {\n    glipGroups,\n    glipPosts,\n  },\n}) {\n  return {\n    groupId: params.groupId,\n    group: glipGroups.currentGroup,\n    posts: glipGroups.currentGroupPosts,\n    textValue:\n      (\n        glipPosts.postInputs[params.groupId] &&\n        glipPosts.postInputs[params.groupId].text\n      ),\n  };\n}\n\nfunction mapToFunctions(_, {\n  phone: {\n    glipGroups,\n    glipPosts,\n    glipPersons,\n    dateTimeFormat,\n  },\n  dateTimeFormatter = time =>\n    dateTimeFormat.formatDateTime({ utcTimestamp: time }),\n  onViewPersonProfile,\n  onViewGroup,\n  mobile = true,\n}) {\n  return {\n    mobile,\n    loadGroup(groupId) {\n      glipGroups.updateCurrentGroupId(groupId);\n    },\n    async loadNextPage() {\n      await glipPosts.loadNextPage(glipGroups.currentGroupId);\n    },\n    async createPost() {\n      await glipPosts.create({\n        groupId: glipGroups.currentGroupId,\n      });\n    },\n    updateText(text, mentions) {\n      glipPosts.updatePostInput({\n        text,\n        groupId: glipGroups.currentGroupId,\n        mentions,\n      });\n    },\n    uploadFile: (fileName, rawFile) => glipPosts.sendFile({\n      fileName,\n      rawFile,\n      groupId: glipGroups.currentGroupId,\n    }),\n    atRender: getAtRender({\n      glipGroups,\n      glipPersons,\n      onViewPersonProfile,\n      onViewGroup,\n    }),\n    viewProfile(personId) {\n      if (personId) {\n        onViewPersonProfile(personId);\n      }\n    },\n    dateTimeFormatter,\n  };\n}\n\nconst GlipChatPage = withPhone(connect(\n  mapToProps,\n  mapToFunctions\n)(GlipChatPanel));\n\nexport default GlipChatPage;\n"]}