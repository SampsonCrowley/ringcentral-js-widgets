{"version":3,"sources":["containers/CallCtrlPage/index.js"],"names":["mapToProps","_","phone","webphone","locale","contactMatcher","regionSettings","brand","forwardingNumber","contactSearch","conferenceCall","callingSettings","rolesAndPermissions","params","children","sessionId","currentSession","sessions","find","session","id","activeSession","contactMapping","dataMapping","fromMatches","from","toMatches","to","nameMatches","direction","callDirections","outbound","isWebRTC","callingMode","callingModes","isInboundCall","inbound","isOnConference","hasConferenceCall","isMerging","conferenceCallParties","conferenceCallId","lastCallInfo","isConferenceCallOverload","conferenceCallEquipped","hasConferenceCallPermission","isConferenceSession","conferenceData","Object","values","conferences","conference","isOverload","partyProfiles","fromSessionId","mergingPair","status","sessionStatus","finished","fullName","currentLocale","areaCode","countryCode","flipNumbers","showBackButton","searchContactList","sortedResult","showSpinner","mapToFunctions","routerInteraction","callMonitor","getAvatarUrl","onBackButtonClick","phoneTypeRenderer","phoneSourceNameRenderer","getInitialLayout","layout","callCtrlLayouts","normalCtrl","conferenceCtrl","fromSession","x","activeSessionId","callStatus","onHold","mergeCtrl","formatPhone","phoneNumber","onHangup","hangup","mergeControlClickHangupTrack","onMute","mute","onUnmute","unmute","hold","onUnhold","unhold","onRecord","startRecord","onStopRecord","stopRecord","sendDTMF","value","updateSessionMatchedContact","contact","onFlip","flipNumber","flip","onTransfer","push","onPark","park","searchContact","searchString","debouncedSearch","onAdd","callControlClickAddTrack","validateCallRecording","fromNumber","otherCalls","call","webphoneSession","allCalls","length","setMergeParty","onBeforeMerge","conferenceSession","onMerge","parseMergingSessions","mergeSessions","gotoParticipantsCtrl","callControlClickParticipantAreaTrack","loadConference","confId","closeMergingPair","afterHideMergeConfirm","confirmMergeClickCloseTrack","afterConfirmMerge","confirmMergeClickMergeTrack","afterOnMerge","callControlClickMergeTrack","CallCtrlPage","CallCtrlContainer"],"mappings":"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","sourcesContent":["import { find, filter } from 'ramda';\nimport { connect } from 'react-redux';\nimport formatNumber from 'ringcentral-integration/lib/formatNumber';\nimport callDirections from 'ringcentral-integration/enums/callDirections';\nimport callingModes from 'ringcentral-integration/modules/CallingSettings/callingModes';\nimport sessionStatus from 'ringcentral-integration/modules/Webphone/sessionStatus';\nimport { withPhone } from '../../lib/phoneContext';\nimport callCtrlLayouts from '../../enums/callCtrlLayouts';\nimport CallCtrlContainer from './CallCtrlContainer';\n\nfunction mapToProps(_, {\n  phone: {\n    webphone,\n    locale,\n    contactMatcher,\n    regionSettings,\n    brand,\n    forwardingNumber,\n    contactSearch,\n    conferenceCall,\n    callingSettings,\n    rolesAndPermissions,\n  },\n  params,\n  children,\n}) {\n  const sessionId = params && params.sessionId;\n  let currentSession;\n\n  if (sessionId) {\n    currentSession = webphone.sessions.find(session => session.id === sessionId) || {};\n  } else {\n    currentSession = webphone.activeSession || {};\n  }\n\n  const contactMapping = contactMatcher && contactMatcher.dataMapping;\n  const fromMatches = (contactMapping && contactMapping[currentSession.from]) || [];\n  const toMatches = (contactMapping && contactMapping[currentSession.to]) || [];\n  const nameMatches =\n    currentSession.direction === callDirections.outbound ? toMatches : fromMatches;\n\n  const isWebRTC = callingSettings.callingMode === callingModes.webphone;\n  const isInboundCall = currentSession.direction === callDirections.inbound;\n\n  let isOnConference = false;\n  let hasConferenceCall = false;\n  let isMerging = false;\n  let conferenceCallParties;\n  let conferenceCallId = null;\n  const lastCallInfo = conferenceCall && conferenceCall.lastCallInfo;\n  let isConferenceCallOverload = false;\n  const conferenceCallEquipped =\n    !!(conferenceCall && rolesAndPermissions.hasConferenceCallPermission);\n  if (conferenceCallEquipped) {\n    isOnConference = conferenceCall.isConferenceSession(currentSession.id);\n    const conferenceData = Object.values(conferenceCall.conferences)[0];\n\n    isMerging = conferenceCall.isMerging;\n\n    if (conferenceData && isWebRTC) {\n      conferenceCallId = conferenceData.conference.id;\n      isConferenceCallOverload = conferenceCall.isOverload(conferenceCallId);\n    }\n\n    hasConferenceCall = !!conferenceData;\n    conferenceCallParties = conferenceCall.partyProfiles;\n\n    const { fromSessionId } = conferenceCall.mergingPair;\n    if (\n      (!isInboundCall &&\n        (\n          fromSessionId &&\n          fromSessionId !== currentSession.id &&\n          lastCallInfo &&\n          lastCallInfo.status &&\n          lastCallInfo.status !== sessionStatus.finished\n        ))\n    ) {\n      // for mergeCtrl page, we don't show any children (container) component.\n      children = null;\n    }\n  }\n\n  return {\n    brand: brand.fullName,\n    nameMatches,\n    currentLocale: locale.currentLocale,\n    session: currentSession,\n    areaCode: regionSettings.areaCode,\n    countryCode: regionSettings.countryCode,\n    flipNumbers: forwardingNumber.flipNumbers,\n    showBackButton: true, // callMonitor.calls.length > 0,\n    searchContactList: contactSearch.sortedResult,\n    showSpinner: isMerging,\n    conferenceCallEquipped,\n    hasConferenceCall,\n    conferenceCallParties,\n    conferenceCallId,\n    lastCallInfo,\n    children,\n    isOnConference,\n    isWebRTC,\n    isConferenceCallOverload,\n  };\n}\n\nfunction mapToFunctions(_, {\n  phone: {\n    webphone,\n    regionSettings,\n    contactSearch,\n    conferenceCall,\n    callingSettings,\n    routerInteraction,\n    callMonitor,\n  },\n  getAvatarUrl,\n  onBackButtonClick,\n  phoneTypeRenderer,\n  phoneSourceNameRenderer,\n}) {\n  return {\n    getInitialLayout({\n      conferenceCallEquipped,\n      isOnConference,\n      lastCallInfo,\n      session\n    }) {\n      let layout = callCtrlLayouts.normalCtrl;\n\n      if (!conferenceCallEquipped) {\n        return layout;\n      }\n\n      if (isOnConference) {\n        return callCtrlLayouts.conferenceCtrl;\n      }\n      const isInboundCall = session.direction === callDirections.inbound;\n\n      const { fromSessionId } = conferenceCall.mergingPair;\n      const fromSession = find(x => x.id === fromSessionId, webphone.sessions);\n\n      const activeSessionId = webphone && webphone.activeSession && webphone.activeSession.id;\n\n      if (!isOnConference &&\n        !isInboundCall &&\n        (\n          fromSession &&\n          (fromSessionId !== session.id) &&\n          lastCallInfo\n        ) &&\n        (\n          session.callStatus !== sessionStatus.onHold ||\n          (session.callStatus === sessionStatus.onHold && session.id === activeSessionId)\n        )\n      ) {\n        // enter merge ctrl page.\n        layout = callCtrlLayouts.mergeCtrl;\n      }\n\n      return layout;\n    },\n    formatPhone: phoneNumber => formatNumber({\n      phoneNumber,\n      areaCode: regionSettings.areaCode,\n      countryCode: regionSettings.countryCode,\n    }),\n    onHangup(sessionId, layout) {\n      webphone.hangup(sessionId);\n      if (layout && layout === callCtrlLayouts.mergeCtrl) {\n        callMonitor.mergeControlClickHangupTrack();\n      }\n    },\n    onMute: sessionId => webphone.mute(sessionId),\n    onUnmute: sessionId => webphone.unmute(sessionId),\n    onHold: sessionId => webphone.hold(sessionId),\n    onUnhold(sessionId) {\n      webphone.unhold(sessionId);\n    },\n    onRecord: sessionId => webphone.startRecord(sessionId),\n    onStopRecord: sessionId => webphone.stopRecord(sessionId),\n    sendDTMF: (value, sessionId) => webphone.sendDTMF(value, sessionId),\n    updateSessionMatchedContact: (sessionId, contact) => (\n      webphone.updateSessionMatchedContact(sessionId, contact)\n    ),\n    getAvatarUrl,\n    onBackButtonClick,\n    onFlip: (flipNumber, sessionId) => webphone.flip(flipNumber, sessionId),\n    onTransfer(sessionId) {\n      routerInteraction.push(`/transfer/${sessionId}/webphone`);\n    },\n    onPark: sessionId => webphone.park(sessionId),\n    searchContact: searchString => (\n      contactSearch.debouncedSearch({ searchString })\n    ),\n    phoneTypeRenderer,\n    phoneSourceNameRenderer,\n    onAdd(sessionId) {\n      // track user click add on call control\n      callMonitor.callControlClickAddTrack();\n      const session = find(x => x.id === sessionId, webphone.sessions);\n      if (!session || !conferenceCall.validateCallRecording(session)) {\n        return;\n      }\n      let fromNumber = callingSettings.fromNumber;\n      if (session.direction === callDirections.outbound) {\n        fromNumber = session.fromNumber; // keep the same fromNumber\n      }\n      const otherCalls = filter(\n        call => (\n          call.webphoneSession &&\n          call.webphoneSession.id !== session.id\n        ),\n        callMonitor.allCalls\n      );\n      if (otherCalls.length) {\n        // goto 'calls on hold' page\n        routerInteraction.push(`/conferenceCall/callsOnhold/${fromNumber}/${session.id}`);\n      } else {\n        if (conferenceCall) {\n          conferenceCall.setMergeParty({ fromSessionId: sessionId });\n        }\n        // goto dialer directly\n        routerInteraction.push(`/conferenceCall/dialer/${fromNumber}/${sessionId}`);\n      }\n    },\n    onBeforeMerge(sessionId) {\n      const session = find(x => x.id === sessionId, webphone.sessions);\n      if (!session || !conferenceCall.validateCallRecording(session)) {\n        return false;\n      }\n      if (conferenceCall) {\n        const conferenceData = Object.values(conferenceCall.conferences)[0];\n        if (conferenceData) {\n          const conferenceSession = find(x => x.id === conferenceData.sessionId, webphone.sessions);\n          if (conferenceSession && !conferenceCall.validateCallRecording(conferenceSession)) {\n            return false;\n          }\n        }\n      }\n      return true;\n    },\n    async onMerge(sessionId) {\n      const sessions = await conferenceCall.parseMergingSessions({ sessionId });\n      if (sessions) {\n        await conferenceCall.mergeSessions(sessions);\n      }\n    },\n\n    gotoParticipantsCtrl() {\n      routerInteraction.push('/conferenceCall/participants');\n      // track user click participant area on call control\n      callMonitor.callControlClickParticipantAreaTrack();\n    },\n    loadConference(confId) {\n      if (conferenceCall) {\n        conferenceCall.loadConference(confId);\n      }\n    },\n    closeMergingPair() {\n      return conferenceCall && conferenceCall.closeMergingPair();\n    },\n    setMergeParty(...args) {\n      return conferenceCall && conferenceCall.setMergeParty(...args);\n    },\n    // user action track functions\n    afterHideMergeConfirm: () => callMonitor.confirmMergeClickCloseTrack(),\n    afterConfirmMerge: () => callMonitor.confirmMergeClickMergeTrack(),\n    afterOnMerge: () => callMonitor.callControlClickMergeTrack()\n  };\n}\n\nconst CallCtrlPage = withPhone(connect(\n  mapToProps,\n  mapToFunctions,\n)(CallCtrlContainer));\n\nexport {\n  mapToProps,\n  mapToFunctions,\n  CallCtrlContainer,\n  CallCtrlPage as default,\n};\n"],"file":"index.js"}