{"version":3,"sources":["containers/CallsListPage/index.js"],"names":["mapToProps","_","phone","brand","callLogger","callMonitor","locale","regionSettings","rolesAndPermissions","callHistory","connectivityMonitor","rateLimiter","dateTimeFormat","call","composeText","showContactDisplayPlaceholder","enableContactFallback","currentLocale","activeRingCalls","activeOnHoldCalls","activeCurrentCalls","otherDeviceCalls","areaCode","countryCode","outboundSmsPermission","permissions","OutboundSMS","internalSmsPermission","InternalSMS","fullName","autoLog","calls","latestCalls","disableLinks","connectivity","throttling","disableClickToDial","isIdle","loggingMap","showSpinner","ready","readTextPermission","readTextPermissions","mapToFunctions","contactMatcher","contactSearch","routerInteraction","webphone","dialerUI","composeTextRoute","callCtrlRoute","onCreateContact","onLogCall","isLoggedContact","onViewContact","dateTimeFormatter","utcTimestamp","formatDateTime","dialerRoute","formatPhone","phoneNumber","webphoneAnswer","answer","webphoneToVoicemail","toVoiceMail","webphoneReject","reject","webphoneHangup","hangup","webphoneResume","resume","currentPath","push","name","entityType","hasMatchNumber","ignoreCache","forceMatchNumber","undefined","contact","redirect","logCall","type","id","onClickToDial","recipient","onClickToCall","onClickToSms","isDummyContact","updateTypingToNumber","search","searchString","addToNumber","typingToNumber","cleanTypingToNumber","onClickToSMS","CallsListPage","CallsListPanel"],"mappings":"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","sourcesContent":["import { connect } from 'react-redux';\nimport formatNumber from 'ringcentral-integration/lib/formatNumber';\nimport { withPhone } from '../../lib/phoneContext';\n\nimport CallsListPanel from '../../components/CallsListPanel';\n\n// TODO it is ActiveCallsPage's function is the same, and remove ActiveCallsPage after migration.\n\nfunction mapToProps(_, {\n  phone: {\n    brand,\n    callLogger,\n    callMonitor,\n    locale,\n    regionSettings,\n    rolesAndPermissions,\n    callHistory,\n    connectivityMonitor,\n    rateLimiter,\n    dateTimeFormat,\n    call,\n    composeText,\n  },\n  showContactDisplayPlaceholder = false,\n  enableContactFallback = false,\n}) {\n  return {\n    currentLocale: locale.currentLocale,\n    activeRingCalls: callMonitor.activeRingCalls,\n    activeOnHoldCalls: callMonitor.activeOnHoldCalls,\n    activeCurrentCalls: callMonitor.activeCurrentCalls,\n    otherDeviceCalls: callMonitor.otherDeviceCalls,\n    areaCode: regionSettings.areaCode,\n    countryCode: regionSettings.countryCode,\n    outboundSmsPermission: !!(\n      rolesAndPermissions.permissions &&\n      rolesAndPermissions.permissions.OutboundSMS\n    ),\n    internalSmsPermission: !!(\n      rolesAndPermissions.permissions &&\n      rolesAndPermissions.permissions.InternalSMS\n    ),\n    // showSpinner: false,\n    brand: brand.fullName,\n    showContactDisplayPlaceholder,\n    autoLog: !!(callLogger && callLogger.autoLog),\n    enableContactFallback,\n    calls: callHistory.latestCalls,\n    disableLinks: !connectivityMonitor.connectivity ||\n    rateLimiter.throttling,\n    disableClickToDial: !(call && call.isIdle),\n    loggingMap: (callLogger && callLogger.loggingMap),\n    showSpinner: !(\n      callHistory.ready &&\n      locale.ready &&\n      regionSettings.ready &&\n      dateTimeFormat.ready &&\n      connectivityMonitor.ready &&\n      (!rolesAndPermissions || rolesAndPermissions.ready) &&\n      (!call || call.ready) &&\n      (!composeText || composeText.ready) &&\n      (!callLogger || callLogger.ready)\n    ),\n    readTextPermission: rolesAndPermissions.readTextPermissions,\n  };\n}\n\nfunction mapToFunctions(_, {\n  phone: {\n    callLogger,\n    composeText,\n    contactMatcher,\n    contactSearch,\n    regionSettings,\n    routerInteraction,\n    webphone,\n    dateTimeFormat,\n    call,\n    dialerUI,\n    callHistory,\n  },\n  composeTextRoute = '/composeText',\n  callCtrlRoute = '/calls/active',\n  onCreateContact,\n  onLogCall,\n  isLoggedContact,\n  onViewContact,\n  dateTimeFormatter = ({ utcTimestamp }) => dateTimeFormat.formatDateTime({\n    utcTimestamp,\n  }),\n  dialerRoute = '/dialer',\n}) {\n  return {\n    formatPhone: phoneNumber => formatNumber({\n      phoneNumber,\n      areaCode: regionSettings.areaCode,\n      countryCode: regionSettings.countryCode,\n    }),\n    webphoneAnswer: (...args) => (webphone && webphone.answer(...args)),\n    webphoneToVoicemail: (...args) => (webphone && webphone.toVoiceMail(...args)),\n    webphoneReject: (...args) => (webphone && webphone.reject(...args)),\n    webphoneHangup: (...args) => (webphone && webphone.hangup(...args)),\n    async webphoneResume(...args) {\n      if (!webphone) {\n        return;\n      }\n      await webphone.resume(...args);\n      if (routerInteraction.currentPath !== callCtrlRoute) {\n        routerInteraction.push(callCtrlRoute);\n      }\n    },\n    onCreateContact: onCreateContact ?\n      async ({ phoneNumber, name, entityType }) => {\n        const hasMatchNumber = await contactMatcher.hasMatchNumber({\n          phoneNumber,\n          ignoreCache: true\n        });\n        if (!hasMatchNumber) {\n          await onCreateContact({ phoneNumber, name, entityType });\n          await contactMatcher.forceMatchNumber({ phoneNumber });\n        }\n      } :\n      undefined,\n    isLoggedContact,\n    onLogCall: onLogCall ||\n    (callLogger && (async ({ call, contact, redirect = true }) => {\n      await callLogger.logCall({\n        call,\n        contact,\n        redirect,\n      });\n    })),\n\n    dateTimeFormatter,\n    onViewContact: onViewContact || (({ contact: { type, id } }) => {\n      routerInteraction.push(`/contacts/${type}/${id}?direct=true`);\n    }),\n    onClickToDial: dialerUI ?\n      (recipient) => {\n        if (call.isIdle) {\n          routerInteraction.push(dialerRoute);\n          dialerUI.call({ recipient });\n          callHistory.onClickToCall();\n        }\n      } :\n      undefined,\n    onClickToSms: composeText ?\n      async (contact, isDummyContact = false) => {\n        if (routerInteraction) {\n          routerInteraction.push(composeTextRoute);\n        }\n        // if contact autocomplete, if no match fill the number only\n        if (contact.name && contact.phoneNumber && isDummyContact) {\n          composeText.updateTypingToNumber(contact.name);\n          contactSearch.search({ searchString: contact.name });\n        } else {\n          composeText.addToNumber(contact);\n          if (composeText.typingToNumber === contact.phoneNumber) {\n            composeText.cleanTypingToNumber();\n          }\n        }\n        callHistory.onClickToSMS();\n      } :\n      undefined,\n  };\n}\n\nconst CallsListPage = withPhone(connect(mapToProps, mapToFunctions)(CallsListPanel));\n\nexport default CallsListPage;\n"],"file":"index.js"}