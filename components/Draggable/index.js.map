{"version":3,"sources":["components/Draggable/index.js"],"names":["Draggable","props","state","dragging","positionX","positionY","translateX","positionOffsetX","translateY","positionOffsetY","_isClick","_onMouseDown","e","button","setState","clientX","clientY","_positionXOnMouseDown","_positionYOnMouseDown","window","addEventListener","_onMouseMove","_onMouseUp","stopPropagation","preventDefault","draggableDom","offsetParent","originalPositionX","offsetLeft","originalPositionY","offsetTop","newPositionX","newPositionY","child","firstChild","height","clientHeight","width","clientWidth","Math","abs","clickThreshold","preState","newState","updatePositionOffset","removeEventListener","_onClick","onClick","className","children","style","msTransition","WebkitTransition","transform","styles","root","Component","propTypes","PropTypes","string","node","isRequired","func","number","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\n\nimport styles from './styles.scss';\n/* eslint { \"react/no-unused-state\": 0 } */\n\nclass Draggable extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      dragging: false,\n      positionX: 0,\n      positionY: 0,\n      translateX: props.positionOffsetX,\n      translateY: props.positionOffsetY,\n    };\n\n    this._isClick = true;\n    this._onMouseDown = (e) => {\n      if (e.button !== 0) return;\n      if (this.state.dragging) {\n        return;\n      }\n      this.setState({\n        positionX: e.clientX,\n        positionY: e.clientY,\n        dragging: true,\n      });\n      this._positionXOnMouseDown = e.clientX;\n      this._positionYOnMouseDown = e.clientY;\n      this._isClick = true;\n      window.addEventListener('mousemove', this._onMouseMove, false);\n      window.addEventListener('mouseup', this._onMouseUp, false);\n      e.stopPropagation();\n      e.preventDefault();\n    };\n\n    this._onMouseMove = (e) => {\n      if (!this.state.dragging) {\n        return;\n      }\n      if (!this.draggableDom) {\n        return;\n      }\n      const {\n        offsetParent,\n        offsetLeft: originalPositionX,\n        offsetTop: originalPositionY,\n      } = this.draggableDom;\n      const newPositionX = e.clientX;\n      const newPositionY = e.clientY;\n      const child = this.draggableDom.firstChild;\n      const height = (child && child.clientHeight) || 0;\n      const width = (child && child.clientWidth) || 0;\n      if (\n        Math.abs(newPositionX - this._positionXOnMouseDown) > this.props.clickThreshold ||\n        Math.abs(newPositionY - this._positionYOnMouseDown) > this.props.clickThreshold\n      ) {\n        this._isClick = false;\n      }\n      this.setState((preState) => {\n        const newState = {\n          positionX: newPositionX,\n          positionY: newPositionY,\n          translateX: preState.translateX + (newPositionX - preState.positionX),\n          translateY: preState.translateY + (newPositionY - preState.positionY),\n        };\n        if (\n          (originalPositionX - 10) + newState.translateX > offsetParent.clientWidth ||\n          (originalPositionX - 10) + newState.translateX < width\n        ) {\n          delete newState.translateX;\n        }\n        if (\n          (originalPositionY + 10) + newState.translateY > offsetParent.clientHeight - height ||\n          (originalPositionY + 10) + newState.translateY < 0\n        ) {\n          delete newState.translateY;\n        }\n        return newState;\n      });\n      e.stopPropagation();\n      e.preventDefault();\n    };\n\n    this._onMouseUp = (e) => {\n      this.setState({\n        dragging: false,\n      });\n      this.props.updatePositionOffset(this.state.translateX, this.state.translateY);\n      window.removeEventListener('mousemove', this._onMouseMove);\n      window.removeEventListener('mouseup', this._onMouseUp);\n      e.stopPropagation();\n      e.preventDefault();\n    };\n\n    this._onClick = (e) => {\n      if (!this._isClick) {\n        return;\n      }\n      this.props.onClick(e);\n    };\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('mousemove', this._onMouseMove);\n    window.removeEventListener('mouseup', this._onMouseUp);\n  }\n\n  render() {\n    const {\n      className,\n      children,\n    } = this.props;\n    const style = {\n      msTransition: `translate(${this.state.translateX}px, ${this.state.translateY}px)`,\n      WebkitTransition: `translate(${this.state.translateX}px, ${this.state.translateY}px)`,\n      transform: `translate(${this.state.translateX}px, ${this.state.translateY}px)`,\n    };\n    return (\n      <div\n        onMouseDown={this._onMouseDown}\n        ref={(draggableDom) => { this.draggableDom = draggableDom; }}\n        style={style}\n        className={classnames(styles.root, className)}\n        onClick={this._onClick}\n        >\n        {children}\n      </div>\n    );\n  }\n}\n\nDraggable.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node.isRequired,\n  onClick: PropTypes.func,\n  positionOffsetX: PropTypes.number,\n  positionOffsetY: PropTypes.number,\n  updatePositionOffset: PropTypes.func,\n  clickThreshold: PropTypes.number,\n};\n\nDraggable.defaultProps = {\n  className: null,\n  onClick: () => null,\n  positionOffsetX: 0,\n  positionOffsetY: 0,\n  updatePositionOffset: () => null,\n  clickThreshold: 5,\n};\n\nexport default Draggable;\n"],"file":"index.js"}