{"version":3,"sources":["containers/GlipChat/index.js"],"names":["getAtRender","glipGroups","glipPersons","onViewPersonProfile","onViewGroup","AtRender","id","type","name","group","allGroups","find","g","person","personsMap","firstName","lastName","onClickAtLink","e","preventDefault","propTypes","PropTypes","string","isRequired","mapToProps","_","params","phone","glipPosts","groupId","currentGroup","posts","currentGroupPosts","textValue","postInputs","text","mapToFunctions","dateTimeFormat","dateTimeFormatter","time","formatDateTime","utcTimestamp","mobile","loadGroup","updateCurrentGroupId","loadNextPage","currentGroupId","createPost","create","updateText","mentions","updatePostInput","uploadFile","fileName","rawFile","sendFile","atRender","viewProfile","personId","GlipChatPage","GlipChatPanel"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport withPhone from 'ringcentral-widgets/lib/withPhone';\n\nimport GlipChatPanel from '../../components/GlipChatPanel';\n\nfunction getAtRender({\n  glipGroups, glipPersons, onViewPersonProfile, onViewGroup\n}) {\n  const AtRender = ({ id, type }) => {\n    let name = id;\n    if (type === 'Team') {\n      const group = glipGroups.allGroups.find(g => g.id === id);\n      name = group && group.name;\n    } else {\n      const person = glipPersons.personsMap[id];\n      name = (\n        person &&\n        `${person.firstName}${person.lastName ? ` ${person.lastName}` : ''}`\n      ) || id;\n    }\n    const onClickAtLink = (e) => {\n      e.preventDefault();\n      if (type === 'Person') {\n        onViewPersonProfile(id);\n      } else if (type === 'Team') {\n        onViewGroup(id);\n      }\n    };\n    return (\n      <a href={`#${id}`} onClick={onClickAtLink}>@{name}</a>\n    );\n  };\n  AtRender.propTypes = {\n    id: PropTypes.string.isRequired,\n    type: PropTypes.string.isRequired,\n  };\n  return AtRender;\n}\n\nfunction mapToProps(_, {\n  params,\n  phone: {\n    glipGroups,\n    glipPosts,\n  },\n}) {\n  return {\n    groupId: params.groupId,\n    group: glipGroups.currentGroup,\n    posts: glipGroups.currentGroupPosts,\n    textValue:\n      (\n        glipPosts.postInputs[params.groupId] &&\n        glipPosts.postInputs[params.groupId].text\n      ),\n  };\n}\n\nfunction mapToFunctions(_, {\n  phone: {\n    glipGroups,\n    glipPosts,\n    glipPersons,\n    dateTimeFormat,\n  },\n  dateTimeFormatter = time =>\n    dateTimeFormat.formatDateTime({ utcTimestamp: time }),\n  onViewPersonProfile,\n  onViewGroup,\n  mobile = true,\n}) {\n  return {\n    mobile,\n    loadGroup(groupId) {\n      glipGroups.updateCurrentGroupId(groupId);\n    },\n    async loadNextPage() {\n      await glipPosts.loadNextPage(glipGroups.currentGroupId);\n    },\n    async createPost() {\n      await glipPosts.create({\n        groupId: glipGroups.currentGroupId,\n      });\n    },\n    updateText(text, mentions) {\n      glipPosts.updatePostInput({\n        text,\n        groupId: glipGroups.currentGroupId,\n        mentions,\n      });\n    },\n    uploadFile: (fileName, rawFile) => glipPosts.sendFile({\n      fileName,\n      rawFile,\n      groupId: glipGroups.currentGroupId,\n    }),\n    atRender: getAtRender({\n      glipGroups,\n      glipPersons,\n      onViewPersonProfile,\n      onViewGroup,\n    }),\n    viewProfile(personId) {\n      if (personId) {\n        onViewPersonProfile(personId);\n      }\n    },\n    dateTimeFormatter,\n  };\n}\n\nconst GlipChatPage = withPhone(connect(\n  mapToProps,\n  mapToFunctions\n)(GlipChatPanel));\n\nexport default GlipChatPage;\n"],"file":"index.js"}