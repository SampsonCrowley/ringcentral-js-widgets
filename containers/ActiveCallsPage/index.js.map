{"version":3,"sources":["containers/ActiveCallsPage/index.js"],"names":["mapToProps","_","phone","brand","callLogger","callMonitor","locale","regionSettings","rolesAndPermissions","conferenceCall","callingSettings","showContactDisplayPlaceholder","isWebRTC","callingMode","callingModes","webphone","conferenceCallEquipped","disableMerge","conferenceList","conferences","conference","length","isOverload","id","currentLocale","activeRingCalls","activeOnHoldCalls","activeCurrentCalls","otherDeviceCalls","areaCode","countryCode","outboundSmsPermission","permissions","OutboundSMS","internalSmsPermission","InternalSMS","showSpinner","isMerging","fullName","autoLog","conferenceCallParties","partyProfiles","mapToFunctions","composeText","contactMatcher","contactSearch","routerInteraction","composeTextRoute","callCtrlRoute","onCreateContact","onLogCall","isLoggedContact","onCallsEmpty","onViewContact","showViewContact","formatPhone","phoneNumber","webphoneAnswer","answer","webphoneToVoicemail","toVoiceMail","webphoneReject","reject","webphoneHangup","hangup","webphoneResume","resume","currentPath","push","contact","type","onClickToSms","isDummyContact","clean","name","updateTypingToNumber","search","searchString","addToRecipients","undefined","entityType","hasMatchNumber","ignoreCache","forceMatchNumber","call","redirect","logCall","sessions","isSessionAConferenceCall","sessionId","isConferenceSession","ActiveCallsPage","ActiveCallsPanel","default"],"mappings":"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","file":"index.js","sourcesContent":["import { connect } from 'react-redux';\nimport formatNumber from 'ringcentral-integration/lib/formatNumber';\nimport sleep from 'ringcentral-integration/lib/sleep';\nimport callingModes from 'ringcentral-integration/modules/CallingSettings/callingModes';\nimport withPhone from '../../lib/withPhone';\nimport ActiveCallsPanel from '../../components/ActiveCallsPanel';\n\nfunction mapToProps(_, {\n  phone: {\n    brand,\n    callLogger,\n    callMonitor,\n    locale,\n    regionSettings,\n    rolesAndPermissions,\n    conferenceCall,\n    callingSettings,\n  },\n  showContactDisplayPlaceholder = false,\n}) {\n  const isWebRTC = callingSettings.callingMode === callingModes.webphone;\n  const conferenceCallEquipped = !!conferenceCall;\n  let disableMerge = !isWebRTC;\n  if (conferenceCallEquipped) {\n    const conferenceList = Object.values(conferenceCall.conferences);\n    const conference = conferenceList.length ? conferenceList[0] : null;\n    if (conference) {\n      disableMerge = conferenceCall.isOverload(conference.conference.id);\n    }\n  }\n  return {\n    currentLocale: locale.currentLocale,\n    activeRingCalls: callMonitor.activeRingCalls,\n    activeOnHoldCalls: callMonitor.activeOnHoldCalls,\n    activeCurrentCalls: callMonitor.activeCurrentCalls,\n    otherDeviceCalls: callMonitor.otherDeviceCalls,\n    areaCode: regionSettings.areaCode,\n    countryCode: regionSettings.countryCode,\n    outboundSmsPermission: !!(\n      rolesAndPermissions.permissions &&\n      rolesAndPermissions.permissions.OutboundSMS\n    ),\n    internalSmsPermission: !!(\n      rolesAndPermissions.permissions &&\n      rolesAndPermissions.permissions.InternalSMS\n    ),\n    showSpinner: !!(conferenceCall && conferenceCall.isMerging),\n    brand: brand.fullName,\n    showContactDisplayPlaceholder,\n    autoLog: !!(callLogger && callLogger.autoLog),\n    isWebRTC,\n    conferenceCallEquipped,\n    disableMerge,\n    conferenceCallParties: conferenceCall ? conferenceCall.partyProfiles : null,\n  };\n}\n\nfunction mapToFunctions(_, {\n  phone: {\n    callLogger,\n    composeText,\n    contactMatcher,\n    contactSearch,\n    regionSettings,\n    routerInteraction,\n    webphone,\n    callingSettings,\n    conferenceCall,\n  },\n  composeTextRoute = '/composeText',\n  callCtrlRoute = '/calls/active',\n  onCreateContact,\n  onLogCall,\n  isLoggedContact,\n  onCallsEmpty,\n  onViewContact,\n  showViewContact = true,\n}) {\n  const isWebRTC = callingSettings.callingMode === callingModes.webphone;\n  return {\n    formatPhone(phoneNumber) {\n      return formatNumber({\n        phoneNumber,\n        areaCode: regionSettings.areaCode,\n        countryCode: regionSettings.countryCode,\n      });\n    },\n    async webphoneAnswer(...args) {\n      return (webphone && webphone.answer(...args));\n    },\n    async webphoneToVoicemail(...args) {\n      return (webphone && webphone.toVoiceMail(...args));\n    },\n    async webphoneReject(...args) {\n      return (webphone && webphone.reject(...args));\n    },\n    async webphoneHangup(...args) {\n      return (webphone && webphone.hangup(...args));\n    },\n    async webphoneResume(...args) {\n      if (!webphone) {\n        return;\n      }\n      await webphone.resume(...args);\n      if (routerInteraction.currentPath !== callCtrlRoute) {\n        routerInteraction.push(callCtrlRoute);\n      }\n    },\n    onViewContact: showViewContact ?\n      (onViewContact || (({ contact }) => {\n        const { id, type } = contact;\n        routerInteraction.push(`/contacts/${type}/${id}?direct=true`);\n      })) : null,\n    onClickToSms: composeText ?\n      async (contact, isDummyContact = false) => {\n        if (routerInteraction) {\n          routerInteraction.push(composeTextRoute);\n        }\n        composeText.clean();\n        if (contact.name && contact.phoneNumber && isDummyContact) {\n          composeText.updateTypingToNumber(contact.name);\n          contactSearch.search({ searchString: contact.name });\n        } else {\n          composeText.addToRecipients(contact);\n        }\n      } :\n      undefined,\n    onCreateContact: onCreateContact ?\n      async ({ phoneNumber, name, entityType }) => {\n        const hasMatchNumber = await contactMatcher.hasMatchNumber({\n          phoneNumber,\n          ignoreCache: true\n        });\n        if (!hasMatchNumber) {\n          await onCreateContact({ phoneNumber, name, entityType });\n          await contactMatcher.forceMatchNumber({ phoneNumber });\n        }\n      } :\n      undefined,\n    isLoggedContact,\n    onLogCall: onLogCall ||\n      (callLogger && (async ({ call, contact, redirect = true }) => {\n        await callLogger.logCall({\n          call,\n          contact,\n          redirect,\n        });\n      })),\n    onCallsEmpty: onCallsEmpty || (() => {\n      if (isWebRTC && !webphone.sessions.length) {\n        routerInteraction.push('/dialer');\n      }\n    }),\n    isSessionAConferenceCall(sessionId) {\n      return !!(\n        conferenceCall\n        && conferenceCall.isConferenceSession(sessionId)\n      );\n    },\n  };\n}\n\nconst ActiveCallsPage = withPhone(connect(\n  mapToProps,\n  mapToFunctions,\n)(ActiveCallsPanel));\n\nexport {\n  mapToProps,\n  mapToFunctions,\n  ActiveCallsPage as default,\n};\n"]}