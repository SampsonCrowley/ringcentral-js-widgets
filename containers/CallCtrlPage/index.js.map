{"version":3,"sources":["containers/CallCtrlPage/index.js"],"names":["CallCtrlPage","props","state","selectedMatcherIndex","avatarUrl","onLastMergingCallEnded","onSelectMatcherName","option","nameMatches","findIndex","match","id","setState","contact","updateSessionMatchedContact","session","getAvatarUrl","then","onMute","onUnmute","onHold","onUnhold","onRecord","onStopRecord","onHangup","onKeyPadChange","sendDTMF","value","onFlip","onTransfer","onPark","onAdd","onMerge","onBeforeMerge","_mounted","_updateAvatarAndMatchIndex","_updateCurrentConferenceCall","nextProps","layout","callCtrlLayouts","mergeCtrl","direction","callDirections","inbound","onIncomingCallCaptured","conferenceCallId","isLastCallEnded","mounted","contactMatch","conferenceCtrl","loadConference","phoneNumber","outbound","to","from","fallbackUserName","i18n","getString","currentLocale","backButtonLabel","formatPhone","callStatus","startTime","isOnMute","isOnHold","isOnFlip","isOnTransfer","recordStatus","showBackButton","onBackButtonClick","areaCode","countryCode","brand","showContactDisplayPlaceholder","flipNumbers","sourceIcons","searchContactList","searchContact","phoneTypeRenderer","recipientsContactInfoRenderer","recipientsContactPhoneRenderer","showSpinner","addDisabled","mergeDisabled","conferenceCallEquipped","hasConferenceCall","conferenceCallParties","lastCallInfo","gotoParticipantsCtrl","children","status","sessionStatus","finished","Component","propTypes","PropTypes","shape","string","number","bool","object","isRequired","func","node","array","defaultProps","undefined","calleeType","calleeTypes","unknow","i","mapToProps","_","phone","webphone","locale","contactMatcher","regionSettings","forwardingNumber","contactSearch","conferenceCall","callingSettings","callMonitor","normalCtrl","params","sessionId","currentSession","sessions","find","activeSession","contactMapping","dataMapping","fromMatches","toMatches","isWebRTC","callingMode","callingModes","isInoundCall","partyData","isOnConference","isMerging","isConferenceSession","conferenceData","conferences","mergingPair","conference","overload","isOverload","partyProfiles","fromSessionId","fullName","sortedResult","mapToFunctions","routerInteraction","closeMergingPair","hangup","mute","unmute","hold","unhold","startRecord","stopRecord","flipNumber","flip","transferNumber","transfer","park","debouncedSearch","searchString","x","isCallRecording","setMergeParty","outBoundOnholdCalls","call","activeOnHoldCalls","length","push","fromNumber","conferenceSession","mergeSession","confId","CallCtrlContainer","default"],"mappings":"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","file":"index.js","sourcesContent":["import { find, filter } from 'ramda';\nimport { connect } from 'react-redux';\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport formatNumber from 'ringcentral-integration/lib/formatNumber';\nimport sleep from 'ringcentral-integration/lib/sleep';\nimport calleeTypes from 'ringcentral-integration/enums/calleeTypes';\nimport callDirections from 'ringcentral-integration/enums/callDirections';\nimport callingModes from 'ringcentral-integration/modules/CallingSettings/callingModes';\nimport sessionStatus from 'ringcentral-integration/modules/Webphone/sessionStatus';\nimport withPhone from '../../lib/withPhone';\nimport callCtrlLayouts from '../../enums/callCtrlLayouts';\nimport CallCtrlPanel from '../../components/CallCtrlPanel';\nimport i18n from './i18n';\n\nclass CallCtrlPage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      selectedMatcherIndex: 0,\n      avatarUrl: null,\n    };\n\n    this.onLastMergingCallEnded = this::this.onLastMergingCallEnded;\n\n    this.onSelectMatcherName = (option) => {\n      const nameMatches = this.props.nameMatches || [];\n      let selectedMatcherIndex = nameMatches.findIndex(\n        match => match.id === option.id\n      );\n      if (selectedMatcherIndex < 0) {\n        selectedMatcherIndex = 0;\n      }\n      this.setState({\n        selectedMatcherIndex,\n        avatarUrl: null,\n      });\n      const contact = nameMatches[selectedMatcherIndex];\n      if (contact) {\n        this.props.updateSessionMatchedContact(this.props.session.id, contact);\n        this.props.getAvatarUrl(contact).then((avatarUrl) => {\n          this.setState({ avatarUrl });\n        });\n      }\n    };\n\n    this.onMute = () =>\n      this.props.onMute(this.props.session.id);\n    this.onUnmute = () =>\n      this.props.onUnmute(this.props.session.id);\n    this.onHold = () =>\n      this.props.onHold(this.props.session.id);\n    this.onUnhold = () =>\n      this.props.onUnhold(this.props.session.id);\n    this.onRecord = () =>\n      this.props.onRecord(this.props.session.id);\n    this.onStopRecord = () =>\n      this.props.onStopRecord(this.props.session.id);\n    this.onHangup = () =>\n      this.props.onHangup(this.props.session.id);\n    this.onKeyPadChange = value =>\n      this.props.sendDTMF(value, this.props.session.id);\n    this.onFlip = value =>\n      this.props.onFlip(value, this.props.session.id);\n    this.onTransfer = value =>\n      this.props.onTransfer(value, this.props.session.id);\n    this.onPark = () =>\n      this.props.onPark(this.props.session.id);\n    this.onAdd = () =>\n      this.props.onAdd(this.props.session.id);\n    this.onMerge = () =>\n      this.props.onMerge(this.props.session.id);\n    this.onBeforeMerge = () =>\n      this.props.onBeforeMerge(this.props.session.id);\n  }\n\n  static isLastCallEnded({ lastCallInfo }) {\n    return !!(\n      lastCallInfo && lastCallInfo.status === sessionStatus.finished\n    );\n  }\n\n  componentDidMount() {\n    this._mounted = true;\n    this._updateAvatarAndMatchIndex(this.props);\n    this._updateCurrentConferenceCall(this.props);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (\n      nextProps.layout === callCtrlLayouts.mergeCtrl &&\n      nextProps.session.direction === callDirections.inbound\n    ) {\n      nextProps.onIncomingCallCaptured();\n    }\n    if (this.props.session.id !== nextProps.session.id) {\n      this._updateAvatarAndMatchIndex(nextProps);\n    }\n    if (this.props.conferenceCallId !== nextProps.conferenceCallId) {\n      this._updateCurrentConferenceCall(nextProps);\n    }\n\n    if (\n      this.props.layout === callCtrlLayouts.mergeCtrl\n      && CallCtrlPage.isLastCallEnded(this.props) === false\n      && CallCtrlPage.isLastCallEnded(nextProps) === true\n      && this.mounted\n    ) {\n      this.onLastMergingCallEnded();\n    }\n  }\n\n  componentWillUnmount() {\n    this._mounted = false;\n  }\n\n  _updateAvatarAndMatchIndex(props) {\n    let contact = props.session.contactMatch;\n    let selectedMatcherIndex = 0;\n    if (!contact) {\n      contact = props.nameMatches && props.nameMatches[0];\n    } else {\n      selectedMatcherIndex = props.nameMatches.findIndex(match =>\n        match.id === contact.id\n      );\n    }\n    this.setState({\n      selectedMatcherIndex,\n      avatarUrl: null,\n    });\n    if (contact) {\n      props.getAvatarUrl(contact).then((avatarUrl) => {\n        if (!this._mounted) {\n          return;\n        }\n        this.setState({ avatarUrl });\n      });\n    }\n  }\n\n  _updateCurrentConferenceCall(props) {\n    if (\n      props.layout === callCtrlLayouts.conferenceCtrl\n      && props.loadConference\n    ) {\n      props.loadConference(props.conferenceCallId);\n    }\n  }\n\n  async onLastMergingCallEnded() {\n    if (\n      this.props.onLastMergingCallEnded\n      && this.mounted\n    ) {\n      await sleep(2000);\n      this.props.onLastMergingCallEnded();\n    }\n  }\n\n  render() {\n    const { session } = this.props;\n    if (!session.id) {\n      return null;\n    }\n\n    const phoneNumber = session.direction === callDirections.outbound ?\n      session.to : session.from;\n\n    let fallbackUserName;\n    if (session.direction === callDirections.inbound && session.from === 'anonymous') {\n      fallbackUserName = i18n.getString('anonymous', this.props.currentLocale);\n    }\n    if (!fallbackUserName) {\n      fallbackUserName = i18n.getString('unknown', this.props.currentLocale);\n    }\n\n    const backButtonLabel = this.props.backButtonLabel\n      ? this.props.backButtonLabel\n      : i18n.getString('activeCalls', this.props.currentLocale);\n\n    return (\n      <CallCtrlPanel\n        currentLocale={this.props.currentLocale}\n        formatPhone={this.props.formatPhone}\n        phoneNumber={phoneNumber}\n        sessionId={session.id}\n        callStatus={session.callStatus}\n        startTime={session.startTime}\n        isOnMute={session.isOnMute}\n        isOnHold={session.isOnHold}\n        isOnFlip={session.isOnFlip}\n        isOnTransfer={session.isOnTransfer}\n        recordStatus={session.recordStatus}\n        showBackButton={this.props.showBackButton}\n        backButtonLabel={backButtonLabel}\n        onBackButtonClick={this.props.onBackButtonClick}\n        onMute={this.onMute}\n        onUnmute={this.onUnmute}\n        onHold={this.onHold}\n        onUnhold={this.onUnhold}\n        onRecord={this.onRecord}\n        onStopRecord={this.onStopRecord}\n        onKeyPadChange={this.onKeyPadChange}\n        onHangup={this.onHangup}\n        onAdd={this.onAdd}\n        onMerge={this.onMerge}\n        onBeforeMerge={this.onBeforeMerge}\n        onFlip={this.onFlip}\n        onTransfer={this.onTransfer}\n        onPark={this.onPark}\n        nameMatches={this.props.nameMatches}\n        fallBackName={fallbackUserName}\n        areaCode={this.props.areaCode}\n        countryCode={this.props.countryCode}\n        selectedMatcherIndex={this.state.selectedMatcherIndex}\n        onSelectMatcherName={this.onSelectMatcherName}\n        avatarUrl={this.state.avatarUrl}\n        brand={this.props.brand}\n        showContactDisplayPlaceholder={this.props.showContactDisplayPlaceholder}\n        flipNumbers={this.props.flipNumbers}\n        sourceIcons={this.props.sourceIcons}\n        searchContactList={this.props.searchContactList}\n        searchContact={this.props.searchContact}\n        phoneTypeRenderer={this.props.phoneTypeRenderer}\n        recipientsContactInfoRenderer={this.props.recipientsContactInfoRenderer}\n        recipientsContactPhoneRenderer={this.props.recipientsContactPhoneRenderer}\n        layout={this.props.layout}\n        showSpinner={this.props.showSpinner}\n        direction={session.direction}\n        addDisabled={this.props.addDisabled}\n        mergeDisabled={this.props.mergeDisabled}\n        conferenceCallEquipped={this.props.conferenceCallEquipped}\n        hasConferenceCall={this.props.hasConferenceCall}\n        conferenceCallParties={this.props.conferenceCallParties}\n        lastCallInfo={this.props.lastCallInfo}\n        getAvatarUrl={this.props.getAvatarUrl}\n        gotoParticipantsCtrl={this.props.gotoParticipantsCtrl}\n        onLastMergingCallEnded={this.props.onLastMergingCallEnded}\n      >\n        {this.props.children}\n      </CallCtrlPanel>\n    );\n  }\n}\n\nCallCtrlPage.propTypes = {\n  session: PropTypes.shape({\n    id: PropTypes.string,\n    direction: PropTypes.string,\n    startTime: PropTypes.number,\n    isOnMute: PropTypes.bool,\n    isOnHold: PropTypes.bool,\n    isOnFlip: PropTypes.bool,\n    isOnTransfer: PropTypes.bool,\n    recordStatus: PropTypes.string,\n    to: PropTypes.string,\n    from: PropTypes.string,\n    contactMatch: PropTypes.object,\n  }).isRequired,\n  currentLocale: PropTypes.string.isRequired,\n  onMute: PropTypes.func.isRequired,\n  onUnmute: PropTypes.func.isRequired,\n  onHold: PropTypes.func.isRequired,\n  onUnhold: PropTypes.func.isRequired,\n  onRecord: PropTypes.func.isRequired,\n  onStopRecord: PropTypes.func.isRequired,\n  onHangup: PropTypes.func.isRequired,\n  sendDTMF: PropTypes.func.isRequired,\n  formatPhone: PropTypes.func.isRequired,\n  onAdd: PropTypes.func,\n  onMerge: PropTypes.func,\n  onBeforeMerge: PropTypes.func,\n  onFlip: PropTypes.func.isRequired,\n  onPark: PropTypes.func.isRequired,\n  onTransfer: PropTypes.func.isRequired,\n  children: PropTypes.node,\n  nameMatches: PropTypes.array.isRequired,\n  areaCode: PropTypes.string.isRequired,\n  countryCode: PropTypes.string.isRequired,\n  getAvatarUrl: PropTypes.func.isRequired,\n  updateSessionMatchedContact: PropTypes.func.isRequired,\n  showBackButton: PropTypes.bool,\n  backButtonLabel: PropTypes.string,\n  onBackButtonClick: PropTypes.func,\n  brand: PropTypes.string.isRequired,\n  showContactDisplayPlaceholder: PropTypes.bool.isRequired,\n  flipNumbers: PropTypes.array.isRequired,\n  sourceIcons: PropTypes.object,\n  searchContactList: PropTypes.array.isRequired,\n  searchContact: PropTypes.func.isRequired,\n  phoneTypeRenderer: PropTypes.func,\n  recipientsContactInfoRenderer: PropTypes.func,\n  recipientsContactPhoneRenderer: PropTypes.func,\n  layout: PropTypes.string.isRequired,\n  showSpinner: PropTypes.bool,\n  addDisabled: PropTypes.bool,\n  mergeDisabled: PropTypes.bool,\n  conferenceCallParties: PropTypes.array,\n  conferenceCallEquipped: PropTypes.bool,\n  hasConferenceCall: PropTypes.bool,\n  lastCallInfo: PropTypes.object,\n  onIncomingCallCaptured: PropTypes.func,\n  conferenceCallId: PropTypes.string,\n  gotoParticipantsCtrl: PropTypes.func,\n  loadConference: PropTypes.func,\n  onLastMergingCallEnded: PropTypes.func,\n};\n\nCallCtrlPage.defaultProps = {\n  children: undefined,\n  showBackButton: false,\n  backButtonLabel: null,\n  onBackButtonClick: null,\n  sourceIcons: undefined,\n  phoneTypeRenderer: undefined,\n  recipientsContactInfoRenderer: undefined,\n  recipientsContactPhoneRenderer: undefined,\n  onAdd: undefined,\n  onMerge: undefined,\n  onBeforeMerge: undefined,\n  showSpinner: false,\n  addDisabled: false,\n  mergeDisabled: false,\n  conferenceCallEquipped: false,\n  hasConferenceCall: false,\n  conferenceCallParties: undefined,\n  lastCallInfo: { calleeType: calleeTypes.unknow },\n  onIncomingCallCaptured: i => i,\n  conferenceCallId: null,\n  gotoParticipantsCtrl: i => i,\n  loadConference: i => i,\n  onLastMergingCallEnded: undefined,\n};\n\nfunction mapToProps(_, {\n  phone: {\n    webphone,\n    locale,\n    contactMatcher,\n    regionSettings,\n    brand,\n    forwardingNumber,\n    contactSearch,\n    conferenceCall,\n    callingSettings,\n    callMonitor,\n  },\n  layout = callCtrlLayouts.normalCtrl,\n  params,\n  children,\n}) {\n  const sessionId = params && params.sessionId;\n  let currentSession;\n\n  if (sessionId) {\n    currentSession = webphone.sessions.find(session => session.id === sessionId) || {};\n  } else {\n    currentSession = webphone.activeSession || {};\n  }\n\n  const contactMapping = contactMatcher && contactMatcher.dataMapping;\n  const fromMatches = (contactMapping && contactMapping[currentSession.from]) || [];\n  const toMatches = (contactMapping && contactMapping[currentSession.to]) || [];\n  const nameMatches =\n    currentSession.direction === callDirections.outbound ? toMatches : fromMatches;\n\n  const isWebRTC = callingSettings.callingMode === callingModes.webphone;\n  const isInoundCall = currentSession.direction === callDirections.inbound;\n  let mergeDisabled = !isWebRTC || isInoundCall || !currentSession.partyData;\n  let addDisabled = !isWebRTC || isInoundCall || !currentSession.partyData;\n\n  let isOnConference = false;\n  let hasConferenceCall = false;\n  let isMerging = false;\n  let conferenceCallParties;\n  let conferenceCallId = null;\n  let lastCallInfo = callMonitor.lastCallInfo;\n  if (conferenceCall) {\n    isOnConference = conferenceCall.isConferenceSession(currentSession.id);\n    const conferenceData = Object.values(conferenceCall.conferences)[0];\n\n    isMerging = conferenceCall.isMerging && !!(\n      Object\n        .values(conferenceCall.mergingPair)\n        .find(id => id === currentSession.id)\n      || (isOnConference)\n    );\n\n    if (conferenceData && isWebRTC) {\n      conferenceCallId = conferenceData.conference.id;\n      const overload = conferenceCall.isOverload(conferenceCallId);\n      if (overload) {\n        mergeDisabled = true;\n        addDisabled = true;\n      }\n    }\n\n    hasConferenceCall = !!conferenceData;\n    conferenceCallParties = conferenceCall.partyProfiles;\n\n    layout = isOnConference ? callCtrlLayouts.conferenceCtrl : layout;\n\n    lastCallInfo = isOnConference ? null : lastCallInfo;\n\n    const { fromSessionId } = conferenceCall.mergingPair;\n    if (\n      !isInoundCall &&\n      (\n        fromSessionId &&\n        fromSessionId !== currentSession.id &&\n        lastCallInfo &&\n        lastCallInfo.status !== sessionStatus.finished\n      )\n    ) {\n      // enter merge ctrl page.\n      layout = callCtrlLayouts.mergeCtrl;\n\n      // for mergeCtrl page, we don't show any children (container) component.\n      children = null;\n    }\n\n    if (\n      layout === callCtrlLayouts.mergeCtrl\n      && (!lastCallInfo || lastCallInfo.status === sessionStatus.finished)\n    ) {\n      mergeDisabled = true;\n    }\n  }\n\n  return {\n    brand: brand.fullName,\n    nameMatches,\n    currentLocale: locale.currentLocale,\n    session: currentSession,\n    areaCode: regionSettings.areaCode,\n    countryCode: regionSettings.countryCode,\n    flipNumbers: forwardingNumber.flipNumbers,\n    showBackButton: true, // callMonitor.calls.length > 0,\n    searchContactList: contactSearch.sortedResult,\n    layout,\n    showSpinner: isMerging,\n    addDisabled,\n    mergeDisabled,\n    conferenceCallEquipped: !!conferenceCall,\n    hasConferenceCall,\n    conferenceCallParties,\n    conferenceCallId,\n    lastCallInfo,\n    children,\n  };\n}\n\nfunction mapToFunctions(_, {\n  phone: {\n    webphone,\n    regionSettings,\n    contactSearch,\n    conferenceCall,\n    routerInteraction,\n    callMonitor,\n  },\n  getAvatarUrl,\n  onBackButtonClick,\n  phoneTypeRenderer,\n  recipientsContactInfoRenderer,\n  recipientsContactPhoneRenderer,\n}) {\n  return {\n    formatPhone: phoneNumber => formatNumber({\n      phoneNumber,\n      areaCode: regionSettings.areaCode,\n      countryCode: regionSettings.countryCode,\n    }),\n    onHangup(sessionId) {\n      if (conferenceCall) {\n        // close the MergingPair if any.\n        conferenceCall.closeMergingPair();\n      }\n      webphone.hangup(sessionId);\n    },\n    onMute: sessionId => webphone.mute(sessionId),\n    onUnmute: sessionId => webphone.unmute(sessionId),\n    onHold: sessionId => webphone.hold(sessionId),\n    onUnhold: sessionId => webphone.unhold(sessionId),\n    onRecord: sessionId => webphone.startRecord(sessionId),\n    onStopRecord: sessionId => webphone.stopRecord(sessionId),\n    sendDTMF: (value, sessionId) => webphone.sendDTMF(value, sessionId),\n    updateSessionMatchedContact: (sessionId, contact) => (\n      webphone.updateSessionMatchedContact(sessionId, contact)\n    ),\n    getAvatarUrl,\n    onBackButtonClick,\n    onFlip: (flipNumber, sessionId) => webphone.flip(flipNumber, sessionId),\n    onTransfer: (transferNumber, sessionId) => webphone.transfer(transferNumber, sessionId),\n    onPark: sessionId => webphone.park(sessionId),\n    searchContact: searchString => (\n      contactSearch.debouncedSearch({ searchString })\n    ),\n    phoneTypeRenderer,\n    recipientsContactInfoRenderer,\n    recipientsContactPhoneRenderer,\n    onAdd(sessionId) {\n      const session = find(x => x.id === sessionId, webphone.sessions);\n      if (!session || webphone.isCallRecording({ session })) {\n        return;\n      }\n      if (conferenceCall) {\n        conferenceCall.setMergeParty({ fromSessionId: sessionId });\n      }\n      const outBoundOnholdCalls = filter(\n        call => call.direction === callDirections.outbound,\n        callMonitor.activeOnHoldCalls\n      );\n      if (outBoundOnholdCalls.length) {\n        // goto 'calls on hold' page\n        routerInteraction.push(`/conferenceCall/callsOnhold/${session.fromNumber}/${session.id}`);\n      } else {\n        // goto dialer directly\n        routerInteraction.push(`/conferenceCall/dialer/${session.fromNumber}`);\n      }\n    },\n    onBeforeMerge(sessionId) {\n      const session = find(x => x.id === sessionId, webphone.sessions);\n      if (!session || webphone.isCallRecording({ session })) {\n        return false;\n      }\n      if (conferenceCall) {\n        const conferenceData = Object.values(conferenceCall.conferences)[0];\n        if (conferenceData) {\n          const conferenceSession = find(x => x.id === conferenceData.sessionId, webphone.sessions);\n          if (conferenceSession && webphone.isCallRecording({ session: conferenceSession })) {\n            return false;\n          }\n        }\n      }\n      return true;\n    },\n    async onMerge(sessionId) {\n      const conferenceData = await conferenceCall.mergeSession({ sessionId });\n      if (!conferenceData) {\n        routerInteraction.push('/conferenceCall/mergeCtrl');\n        return;\n      }\n      routerInteraction.push(`/calls/active/${conferenceData.sessionId}`);\n    },\n    onIncomingCallCaptured() {\n      routerInteraction.push('/calls/active');\n    },\n    gotoParticipantsCtrl() {\n      routerInteraction.push('/conferenceCall/participants');\n    },\n    loadConference(confId) {\n      if (conferenceCall) {\n        conferenceCall.loadConference(confId);\n      }\n    },\n  };\n}\n\nconst CallCtrlContainer = withPhone(connect(\n  mapToProps,\n  mapToFunctions,\n)(CallCtrlPage));\n\nCallCtrlContainer.propTypes = {\n  getAvatarUrl: PropTypes.func,\n  onBackButtonClick: PropTypes.func.isRequired,\n  onAdd: PropTypes.func.isRequired,\n  backButtonLabel: PropTypes.string,\n  children: PropTypes.node,\n  showContactDisplayPlaceholder: PropTypes.bool,\n  sourceIcons: PropTypes.object,\n};\n\nCallCtrlContainer.defaultProps = {\n  getAvatarUrl: () => null,\n  showContactDisplayPlaceholder: false,\n  children: undefined,\n  sourceIcons: undefined,\n};\n\nexport {\n  mapToProps,\n  mapToFunctions,\n  CallCtrlPage,\n  CallCtrlContainer as default,\n};\n"]}