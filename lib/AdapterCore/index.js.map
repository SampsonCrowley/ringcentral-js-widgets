{"version":3,"sources":["lib/AdapterCore/index.js"],"names":["SANDBOX_ATTRIBUTE_VALUE","join","ALLOW_ATTRIBUTE_VALUE","ON_HOLD_CALLS","RINGING_CALLS","CURRENT_CALL","ROTATE_LENGTH","ROTATE_INTERVAL","AdapterCore","prefix","styles","container","root","messageTypes","baseMessageTypes","defaultDirection","defaultPadding","_onWindowResize","_dragging","_resizeTimeout","clearTimeout","setTimeout","_renderRestrictedPosition","_resizeTick","Date","now","_onWindowMouseMove","e","buttons","_renderMainClass","factor","_calculateFactor","delta","x","clientX","_dragStartPosition","y","clientY","_minimized","_minTranslateX","minTranslateX","_minTranslateY","minTranslateY","_translateX","translateX","_translateY","translateY","_isClick","_syncPosition","_debouncedPostMessage","_postMessage","_prefix","_messageTypes","enumMap","_container","ensureExist","_root","_styles","_defaultDirection","_padding","_appWidth","_appHeight","_closed","_hover","_hoverHeader","_loading","_userStatus","_dndStatus","_telephonyStatus","currentState","_scrollale","_strings","msg","type","syncClosed","_onSyncClosed","closed","syncMinimized","_onSyncMinimized","minimized","syncSize","_onSyncSize","size","syncPresence","_onPushPresence","pushAdapterState","_onPushAdapterState","pushLocale","_onPushLocale","pushRingState","_onPushRingState","pushCalls","_onPushCallsInfo","pushOnCurrentCallPath","_onPushOnCurrentCallPath","pushOnAllCallsPath","_onPushOnAllCallsPath","sanboxAttributeValue","allowAttributeValue","header","presence","NoPresence","presenceBar","button","toggle","minimizeIcon","minimizeIconBar","close","closeIcon","logo","duration","ringingCalls","onHoldCalls","currentCallBtn","viewCallsBtn","frameContainer","contentFrame","innerHTML","_getContentDOM","_headerEl","querySelector","_logoEl","addEventListener","_contentFrameContainerEl","_toggleEl","evt","stopPropagation","toggleMinimized","_closeEl","setClosed","_presenceEl","presenceClicked","_contentFrameEl","_durationEl","navigateToCurrentCall","_currentCallEl","_viewCallsEl","navigateToViewCalls","_ringingCallsEl","_onHoldCallsEl","window","_currentStartTime","_hoverBar","_scrollable","_renderCallsBar","_onHeaderClicked","document","readyState","body","appendChild","_beforeRender","_render","data","messageTransport","postMessage","logoUrl","_logoUrl","src","setAttribute","visible","appUrl","_appUrl","contentFrameEl","renderAdapterSize","setMinimized","maximumX","innerWidth","clientWidth","maximumY","innerHeight","clientHeight","minimumX","minimumY","width","height","style","ringing","_ringing","ringingCallsLength","onHoldCallsLength","currentStartTime","_ringingCallsLength","_onHoldCallsLength","_hasActiveCalls","renderCallsBar","onCurrentCallPath","_onCurrentCallPath","onAllCallsPath","_onAllCallsPath","dndStatus","userStatus","telephonyStatus","renderPresence","locale","strings","_locale","_renderString","_renderCallBarBtn","_renderRingingCalls","_renderOnHoldCalls","call","syncPosition","position","_calculateMinMaxPosition","newMinTranslateX","Math","max","min","newMinTranslateY","newTranslateX","newTranslateY","renderPosition","dragging","hover","loading","startTime","round","getTime","rotateInterval","clearInterval","durationInterval","_renderCallDuration","callInfoMap","rotateCallInfo","setInterval","lastState","increment","state","newState","dock","_renderMinimizedBar","showDuration","centerDuration","center","moveOutDuration","moveOut","moveInDuration","moveIn","showRingingCalls","centerCallInfo","moveOutRingingInfo","moveInRingingInfo","showOnHoldCalls","moveOutOnHoldInfo","moveInOnHoldInfo","showCurrentCallBtn","moveOutCurrentCallBtn","moveInCurrentCallBtn","showViewCallsBtn","moveInViewCallsBtn","moveOutViewCallsBtn","calculateState","ringCallsInfo","title","onHoldCallsInfo","removeEventListener","remove","_messageTransport"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,0BAA0B,CAC9B,mBAD8B,EAE9B,eAF8B,EAG9B,aAH8B,EAI9B,cAJ8B,EAK9BC,IAL8B,CAKzB,GALyB,CAAhC;;AAOA;AACA,IAAMC,wBAAwB,CAC5B,YAD4B,EAG5BD,IAH4B,CAGvB,GAHuB,CAA9B;;AAKA,IAAME,gBAAgB,CAAtB;AACA,IAAMC,gBAAgB,CAAtB;AACA,IAAMC,eAAe,CAArB;;AAGA,IAAMC,gBAAgB,CAAtB;AACA,IAAMC,kBAAkB,IAAxB;;IAEqBC,W;AACnB,6BAQG;AAAA;;AAAA,QAPDC,MAOC,QAPDA,MAOC;AAAA,QANDC,MAMC,QANDA,MAMC;AAAA,QALDC,SAKC,QALDA,SAKC;AAAA,yBAJDC,IAIC;AAAA,QAJDA,IAIC,6BAJMD,SAIN;AAAA,iCAHDE,YAGC;AAAA,QAHDA,YAGC,qCAHcC,0BAGd;AAAA,qCAFDC,gBAEC;AAAA,QAFDA,gBAEC,yCAFkB,MAElB;AAAA,mCADDC,cACC;AAAA,QADDA,cACC,uCADgB,EAChB;AAAA;;AAAA,SAkQHC,eAlQG,GAkQe,YAAM;AACtB,UAAI,MAAKC,SAAT,EAAoB;AAAE;AAAS;AAC/B,UAAI,MAAKC,cAAT,EAAyB;AAAEC,qBAAa,MAAKD,cAAlB;AAAoC;AAC/D,YAAKA,cAAL,GAAsBE,WAAW;AAAA,eAAM,MAAKC,yBAAL,EAAN;AAAA,OAAX,EAAmD,GAAnD,CAAtB;AACA,UAAI,CAAC,MAAKC,WAAN,IAAqBC,KAAKC,GAAL,KAAa,MAAKF,WAAlB,GAAgC,EAAzD,EAA6D;AAC3D,cAAKA,WAAL,GAAmBC,KAAKC,GAAL,EAAnB;AACA,cAAKH,yBAAL;AACD;AACF,KA1QE;;AAAA,SA2QHI,kBA3QG,GA2QkB,UAACC,CAAD,EAAO;AAC1B,UAAI,MAAKT,SAAT,EAAoB;AAClB,YAAIS,EAAEC,OAAF,KAAc,CAAlB,EAAqB;AACnB,gBAAKV,SAAL,GAAiB,KAAjB;AACA,gBAAKW,gBAAL;AACA;AACD;AACD,YAAMC,SAAS,MAAKC,gBAAL,EAAf;AACA,YAAMC,QAAQ;AACZC,aAAGN,EAAEO,OAAF,GAAY,MAAKC,kBAAL,CAAwBF,CAD3B;AAEZG,aAAGT,EAAEU,OAAF,GAAY,MAAKF,kBAAL,CAAwBC;AAF3B,SAAd;AAIA,YAAI,MAAKE,UAAT,EAAqB;AACnB,gBAAKC,cAAL,GAAsB,MAAKJ,kBAAL,CAAwBK,aAAxB,GAAwCR,MAAMC,CAAN,GAAUH,MAAxE;AACA,gBAAKW,cAAL,GAAsB,MAAKN,kBAAL,CAAwBO,aAAxB,GAAwCV,MAAMI,CAApE;AACD,SAHD,MAGO;AACL,gBAAKO,WAAL,GAAmB,MAAKR,kBAAL,CAAwBS,UAAxB,GAAqCZ,MAAMC,CAAN,GAAUH,MAAlE;AACA,gBAAKe,WAAL,GAAmB,MAAKV,kBAAL,CAAwBW,UAAxB,GAAqCd,MAAMI,CAA9D;AACD;AACD,YAAIJ,MAAMC,CAAN,KAAY,CAAZ,IAAiBD,MAAMI,CAAN,KAAY,CAAjC,EAAoC,MAAKW,QAAL,GAAgB,KAAhB;AACpC,cAAKC,aAAL;AACA,cAAK1B,yBAAL;AACD;AACF,KAlSE;;AAAA,SA4aH2B,qBA5aG,GA4aqB,wBAAS,KAAKC,YAAd,EAA4B,GAA5B,CA5arB;;AACD,SAAKC,OAAL,GAAe1C,MAAf;AACA,SAAK2C,aAAL,GAAqB,sBAAW,EAAEC,SAASxC,YAAX,EAAyBJ,cAAzB,EAAX,CAArB;AACA,SAAK6C,UAAL,GAAyBC,qBAAP,YAAmB5C,SAAnB,EAA8B,WAA9B,CAAlB;AACA,SAAK6C,KAAL,GAAa5C,IAAb;AACA,SAAK6C,OAAL,GAAe/C,MAAf;AACA,SAAKgD,iBAAL,GAAyB3C,gBAAzB;;AAEA,SAAK4C,QAAL,GAAgB3C,cAAhB;AACA,SAAKuB,cAAL,GAAsB,CAAtB;AACA,SAAKE,cAAL,GAAsB,CAAtB;AACA,SAAKE,WAAL,GAAmB,CAAnB;AACA,SAAKE,WAAL,GAAmB,CAAnB;AACA,SAAKe,SAAL,GAAiB,CAAjB;AACA,SAAKC,UAAL,GAAkB,CAAlB;AACA,SAAK1B,kBAAL,GAA0B,IAA1B;;AAEA,SAAK2B,OAAL,GAAe,IAAf;AACA,SAAKxB,UAAL,GAAkB,IAAlB;AACA,SAAKpB,SAAL,GAAiB,KAAjB;AACA,SAAK6C,MAAL,GAAc,KAAd;AACA,SAAKC,YAAL,GAAoB,KAApB;AACA,SAAKC,QAAL,GAAgB,IAAhB;AACA,SAAKC,WAAL,GAAmB,IAAnB;AACA,SAAKC,UAAL,GAAkB,IAAlB;AACA,SAAKC,gBAAL,GAAwB,IAAxB;;AAEA,SAAKC,YAAL,GAAoB,CAAC,CAArB;AACA,SAAKC,UAAL,GAAkB,KAAlB;;AAEA,SAAKC,QAAL,GAAgB,EAAhB;AACD;;;;+BACUC,G,EAAK;AACd,UAAIA,GAAJ,EAAS;AACP,gBAAQA,IAAIC,IAAZ;AACE,eAAK,KAAKrB,aAAL,CAAmBsB,UAAxB;AACE,iBAAKC,aAAL,CAAmBH,IAAII,MAAvB;AACA;AACF,eAAK,KAAKxB,aAAL,CAAmByB,aAAxB;AACE,iBAAKC,gBAAL,CAAsBN,IAAIO,SAA1B;AACA;AACF,eAAK,KAAK3B,aAAL,CAAmB4B,QAAxB;AACE,iBAAKC,WAAL,CAAiBT,IAAIU,IAArB;AACA;AACF,eAAK,KAAK9B,aAAL,CAAmB+B,YAAxB;AACE,iBAAKC,eAAL,CAAqBZ,GAArB;AACA;AACF,eAAK,KAAKpB,aAAL,CAAmBiC,gBAAxB;AACE,iBAAKC,mBAAL,CAAyBd,GAAzB;AACA;AACF,eAAK,KAAKpB,aAAL,CAAmBmC,UAAxB;AACE,iBAAKC,aAAL,CAAmBhB,GAAnB;AACA;AACF,eAAK,KAAKpB,aAAL,CAAmBqC,aAAxB;AACE,iBAAKC,gBAAL,CAAsBlB,GAAtB;AACA;AACF,eAAK,KAAKpB,aAAL,CAAmBuC,SAAxB;AACE,iBAAKC,gBAAL,CAAsBpB,GAAtB;AACA;AACF,eAAK,KAAKpB,aAAL,CAAmByC,qBAAxB;AACE,iBAAKC,wBAAL,CAA8BtB,GAA9B;AACA;AACF,eAAK,KAAKpB,aAAL,CAAmB2C,kBAAxB;AACE,iBAAKC,qBAAL,CAA2BxB,GAA3B;AACA;AACF;AACE;AAhCJ;AAkCD;AACF;;;mCAEcyB,oB,EAAsBC,mB,EAAqB;AACxD,yCACmB,KAAKzC,OAAL,CAAa0C,MADhC,kDAEkB,KAAK1C,OAAL,CAAa2C,QAF/B,SAE2C,KAAK3C,OAAL,CAAa4C,UAFxD,kCAGoB,KAAK5C,OAAL,CAAa6C,WAHjC,kEAMkB,KAAK7C,OAAL,CAAa8C,MAN/B,SAMyC,KAAK9C,OAAL,CAAa+C,MANtD,kCAOoB,KAAK/C,OAAL,CAAagD,YAPjC,oCAQsB,KAAKhD,OAAL,CAAaiD,eARnC,wEAWkB,KAAKjD,OAAL,CAAa8C,MAX/B,SAWyC,KAAK9C,OAAL,CAAakD,KAXtD,kCAYoB,KAAKlD,OAAL,CAAamD,SAZjC,sGAgBkB,KAAKnD,OAAL,CAAaoD,IAhB/B,wDAiBkB,KAAKpD,OAAL,CAAaqD,QAjB/B,sCAkBkB,KAAKrD,OAAL,CAAasD,YAlB/B,sCAmBkB,KAAKtD,OAAL,CAAauD,WAnB/B,sCAoBkB,KAAKvD,OAAL,CAAawD,cApB/B,UAoBkD,KAAK1C,QAAL,CAAc0C,cApBhE,oCAqBkB,KAAKxD,OAAL,CAAayD,YArB/B,UAqBgD,KAAK3C,QAAL,CAAc2C,YArB9D,mDAuBgB,KAAKzD,OAAL,CAAa0D,cAvB7B,mCAwBqB,KAAK1D,OAAL,CAAa2D,YAxBlC,mBAwB4DnB,oBAxB5D,iBAwB4FC,mBAxB5F;AA2BD;;;0CAEqB;AAAA;;AACpB,WAAK1C,KAAL,CAAW6D,SAAX,GAAuB,KAAKC,cAAL,CAAoBtH,uBAApB,EAA6CE,qBAA7C,CAAvB;AACA,WAAKqH,SAAL,GAAiB,KAAK/D,KAAL,CAAWgE,aAAX,OACX,KAAK/D,OAAL,CAAa0C,MADF,CAAjB;AAGA,WAAKsB,OAAL,GAAe,KAAKjE,KAAL,CAAWgE,aAAX,OACT,KAAK/D,OAAL,CAAaoD,IADJ,CAAf;AAGA,WAAKY,OAAL,CAAaC,gBAAb,CAA8B,WAA9B,EAA2C;AAAA,eAAM,KAAN;AAAA,OAA3C;;AAEA,WAAKC,wBAAL,GAAgC,KAAKnE,KAAL,CAAWgE,aAAX,OAC1B,KAAK/D,OAAL,CAAa0D,cADa,CAAhC;;AAIA;AACA,WAAKS,SAAL,GAAiB,KAAKpE,KAAL,CAAWgE,aAAX,OACX,KAAK/D,OAAL,CAAa+C,MADF,CAAjB;AAGA,WAAKoB,SAAL,CAAeF,gBAAf,CAAgC,OAAhC,EAAyC,UAACG,GAAD,EAAS;AAChDA,YAAIC,eAAJ;AACA,eAAKC,eAAL;AACD,OAHD;;AAKA;AACA,WAAKC,QAAL,GAAgB,KAAKxE,KAAL,CAAWgE,aAAX,OACV,KAAK/D,OAAL,CAAakD,KADH,CAAhB;;AAIA,UAAI,KAAKqB,QAAT,EAAmB;AACjB,aAAKA,QAAL,CAAcN,gBAAd,CAA+B,OAA/B,EAAwC,YAAM;AAC5C,iBAAKO,SAAL,CAAe,IAAf;AACD,SAFD;AAGD;;AAED,WAAKC,WAAL,GAAmB,KAAK1E,KAAL,CAAWgE,aAAX,OACb,KAAK/D,OAAL,CAAa2C,QADA,CAAnB;AAGA,WAAK8B,WAAL,CAAiBR,gBAAjB,CAAkC,OAAlC,EAA2C,UAACG,GAAD,EAAS;AAClDA,YAAIC,eAAJ;AACA,eAAK5E,YAAL,CAAkB;AAChBuB,gBAAM,OAAKrB,aAAL,CAAmB+E;AADT,SAAlB;AAGD,OALD;AAMA,WAAKC,eAAL,GAAuB,KAAK5E,KAAL,CAAWgE,aAAX,OACjB,KAAK/D,OAAL,CAAa2D,YADI,CAAvB;;AAIA,WAAKiB,WAAL,GAAmB,KAAK7E,KAAL,CAAWgE,aAAX,OACb,KAAK/D,OAAL,CAAaqD,QADA,CAAnB;;AAIA,WAAKuB,WAAL,CAAiBX,gBAAjB,CAAkC,OAAlC,EAA2C,UAACG,GAAD,EAAS;AAClDA,YAAIC,eAAJ;AACA,eAAK5E,YAAL,CAAkB;AAChBuB,gBAAM,OAAKrB,aAAL,CAAmBkF;AADT,SAAlB;AAGD,OALD;;AAOA,WAAKC,cAAL,GAAsB,KAAK/E,KAAL,CAAWgE,aAAX,OAChB,KAAK/D,OAAL,CAAawD,cADG,CAAtB;AAGA,WAAKsB,cAAL,CAAoBb,gBAApB,CAAqC,OAArC,EAA8C,UAACG,GAAD,EAAS;AACrDA,YAAIC,eAAJ;AACA,eAAK5E,YAAL,CAAkB;AAChBuB,gBAAM,OAAKrB,aAAL,CAAmBkF;AADT,SAAlB;AAGD,OALD;;AAOA,WAAKE,YAAL,GAAoB,KAAKhF,KAAL,CAAWgE,aAAX,OACd,KAAK/D,OAAL,CAAayD,YADC,CAApB;AAGA,WAAKsB,YAAL,CAAkBd,gBAAlB,CAAmC,OAAnC,EAA4C,UAACG,GAAD,EAAS;AACnDA,YAAIC,eAAJ;AACA,eAAK5E,YAAL,CAAkB;AAChBuB,gBAAM,OAAKrB,aAAL,CAAmBqF;AADT,SAAlB;AAGD,OALD;;AAOA,WAAKC,eAAL,GAAuB,KAAKlF,KAAL,CAAWgE,aAAX,OACjB,KAAK/D,OAAL,CAAasD,YADI,CAAvB;;AAIA,WAAK4B,cAAL,GAAsB,KAAKnF,KAAL,CAAWgE,aAAX,OAChB,KAAK/D,OAAL,CAAauD,WADG,CAAtB;;AAIA,WAAKO,SAAL,CAAeG,gBAAf,CAAgC,WAAhC,EAA6C,UAAC/F,CAAD,EAAO;AAClD,eAAKT,SAAL,GAAiB,IAAjB;AACA,eAAK6B,QAAL,GAAgB,IAAhB;AACA,eAAKZ,kBAAL,GAA0B;AACxBF,aAAGN,EAAEO,OADmB;AAExBE,aAAGT,EAAEU,OAFmB;AAGxBO,sBAAY,OAAKD,WAHO;AAIxBG,sBAAY,OAAKD,WAJO;AAKxBL,yBAAe,OAAKD,cALI;AAMxBG,yBAAe,OAAKD;AANI,SAA1B;AAQA,eAAKZ,gBAAL;AACD,OAZD;AAaA,WAAK0F,SAAL,CAAeG,gBAAf,CAAgC,SAAhC,EAA2C,YAAM;AAC/C,eAAKxG,SAAL,GAAiB,KAAjB;AACA,eAAKW,gBAAL;AACD,OAHD;AAIA+G,aAAOlB,gBAAP,CAAwB,WAAxB,EAAqC,KAAKhG,kBAA1C;;AAEA,WAAK6F,SAAL,CAAeG,gBAAf,CAAgC,YAAhC,EAA8C,YAAM;AAClD,YAAI,CAAC,OAAKpF,UAAV,EAAsB;AACpB,cAAI,OAAKuG,iBAAL,GAAyB,CAA7B,EAAgC;AAC9B,mBAAKC,SAAL,GAAiB,IAAjB;AACA,mBAAKC,WAAL,GAAmB,KAAnB;AACA,mBAAKC,eAAL;AACD;AACD;AACD;AACD,eAAKhF,YAAL,GAAoB,IAApB;AACA,eAAKnC,gBAAL;AACD,OAXD;AAYA,WAAK0F,SAAL,CAAeG,gBAAf,CAAgC,YAAhC,EAA8C,YAAM;AAClD,eAAK1D,YAAL,GAAoB,KAApB;AACA,eAAK8E,SAAL,GAAiB,KAAjB;AACA,eAAKC,WAAL,GAAmB,KAAnB;AACA,eAAKC,eAAL;AACA,eAAKnH,gBAAL;AACD,OAND;;AAQA,WAAKkB,QAAL,GAAgB,IAAhB;AACA,WAAKwE,SAAL,CAAeG,gBAAf,CAAgC,OAAhC,EAAyC,UAACG,GAAD,EAAS;AAChD,YAAI,CAAC,OAAK9E,QAAV,EAAoB;AACpB,eAAKkG,gBAAL,CAAsBpB,GAAtB;AACD,OAHD;;AAKA,WAAK1G,cAAL,GAAsB,IAAtB;AACA,WAAKI,WAAL,GAAmB,IAAnB;AACAqH,aAAOlB,gBAAP,CAAwB,QAAxB,EAAkC,KAAKzG,eAAvC;;AAEA;AACA,WAAKqC,UAAL,CAAgBoE,gBAAhB,CAAiC,YAAjC,EAA+C,YAAM;AACnD,eAAK3D,MAAL,GAAc,IAAd;AACA,eAAKlC,gBAAL;AACD,OAHD;AAIA,WAAKyB,UAAL,CAAgBoE,gBAAhB,CAAiC,YAAjC,EAA+C,YAAM;AACnD,eAAK3D,MAAL,GAAc,KAAd;AACA,eAAKlC,gBAAL;AACD,OAHD;AAIA,UAAIqH,SAASC,UAAT,KAAwB,SAA5B,EAAuC;AACrCP,eAAOlB,gBAAP,CAAwB,MAAxB,EAAgC,YAAM;AACpCwB,mBAASE,IAAT,CAAcC,WAAd,CAA0B,OAAK/F,UAA/B;AACD,SAFD;AAGD,OAJD,MAIO;AACL4F,iBAASE,IAAT,CAAcC,WAAd,CAA0B,KAAK/F,UAA/B;AACD;;AAED,UAAI,OAAO,KAAKgG,aAAZ,KAA8B,UAAlC,EAA8C;AAC5C,aAAKA,aAAL;AACD;AACD,WAAKC,OAAL;AACD;;;iCAuCYC,I,EAAM;AACjB,WAAKC,gBAAL,CAAsBC,WAAtB,CAAkCF,IAAlC;AACD;;;gCAEWG,O,EAAS;AACnB,WAAKC,QAAL,GAAgBD,OAAhB;AACA,WAAKlC,OAAL,CAAaoC,GAAb,GAAmBF,OAAnB;AACA,WAAKlC,OAAL,CAAaqC,YAAb,CAA0B,OAA1B,EAAmC,0BACjC,KAAKrG,OAAL,CAAaoD,IADoB,EAEjC,KAAK+C,QAAL,IAAiB,KAAKA,QAAL,KAAkB,EAAnC,IAAyC,KAAKnG,OAAL,CAAasG,OAFrB,CAAnC;AAID;;;+BAEUC,M,EAAQ;AACjB,WAAKC,OAAL,GAAeD,MAAf;AACA,UAAIA,MAAJ,EAAY;AACV,aAAKE,cAAL,CAAoBL,GAApB,GAA0BG,MAA1B;AACD;AACF;;;qCAEgBjF,S,EAAW;AAC1B,WAAKzC,UAAL,GAAkB,CAAC,CAACyC,SAApB;AACA,WAAKlD,gBAAL;AACA,WAAKsI,iBAAL;AACA,WAAK7I,yBAAL;AACD;;;iCACYyD,S,EAAW;AACtB,WAAKD,gBAAL,CAAsBC,SAAtB;AACA,WAAK7B,YAAL,CAAkB;AAChBuB,cAAM,KAAKrB,aAAL,CAAmByB,aADT;AAEhBE,mBAAW,KAAKzC;AAFA,OAAlB;AAID;;;sCACiB;AAChB,WAAK8H,YAAL,CAAkB,CAAC,KAAK9H,UAAxB;AACD;;;+CAE0B;AACzB,UAAM+H,WAAWzB,OAAO0B,UAAP,IACd,KAAKhI,UAAL,GAAkB,KAAKiF,SAAL,CAAegD,WAAjC,GAA+C,KAAK3G,SADtC,IACmD,IAAI,KAAKD,QAD7E;AAEA,UAAM6G,WAAW5B,OAAO6B,WAAP,IACd,KAAKnI,UAAL,GACC,KAAKiF,SAAL,CAAemD,YADhB,GAEC,KAAKnD,SAAL,CAAemD,YAAf,GAA8B,KAAK7G,UAHtB,IAGoC,KAAKF,QAH1D;AAIA,aAAO;AACLgH,kBAAU,KAAKhH,QADV;AAELiH,kBAAU,KAAKjH,QAFV;AAGL0G,0BAHK;AAILG;AAJK,OAAP;AAMD;;;kCAEa5F,M,EAAQ;AACpB,WAAKd,OAAL,GAAe,CAAC,CAACc,MAAjB;AACA,WAAK/C,gBAAL;AACD;;;8BACS+C,M,EAAQ;AAChB,WAAKD,aAAL,CAAmBC,MAAnB;AACA,WAAK1B,YAAL,CAAkB;AAChBuB,cAAM,KAAKrB,aAAL,CAAmBsB,UADT;AAEhBE,gBAAQ,KAAKA;AAFG,OAAlB;AAID;;;mCACc;AACb,WAAKqD,SAAL,CAAe,CAAC,KAAKrD,MAArB;AACD;;;uCAE8B;AAAA,UAAjBiG,KAAiB,SAAjBA,KAAiB;AAAA,UAAVC,MAAU,SAAVA,MAAU;;AAC7B,WAAKlH,SAAL,GAAiBiH,KAAjB;AACA,WAAKhH,UAAL,GAAkBiH,MAAlB;AACA,WAAK1C,eAAL,CAAqB2C,KAArB,CAA2BF,KAA3B,GAAsCA,KAAtC;AACA,WAAKzC,eAAL,CAAqB2C,KAArB,CAA2BD,MAA3B,GAAuCA,MAAvC;AACA,WAAKX,iBAAL;AACD;;;4BACOjF,I,EAAM;AACZ,WAAKD,WAAL,CAAiBC,IAAjB;AACA,WAAKhC,YAAL,CAAkB;AAChBuB,cAAM,KAAKrB,aAAL,CAAmB4B,QADT;AAEhBE;AAFgB,OAAlB;AAID;;;4CAE6B;AAAA,UAAX8F,OAAW,SAAXA,OAAW;;AAC5B,WAAKC,QAAL,GAAgBD,OAAhB;AACA,WAAKzB,OAAL;AACD;;;4CAE6E;AAAA,UAA3D2B,kBAA2D,SAA3DA,kBAA2D;AAAA,UAAvCC,iBAAuC,SAAvCA,iBAAuC;AAAA,UAApBC,gBAAoB,SAApBA,gBAAoB;;AAC5E,WAAKvC,iBAAL,GAAyBuC,gBAAzB;AACA,WAAKC,mBAAL,GAA2BH,kBAA3B;AACA,WAAKI,kBAAL,GAA0BH,iBAA1B;AACA,WAAKI,eAAL,GAAuB,KAAK1C,iBAAL,GAAyB,CAAzB,IAA8B,KAAKwC,mBAAL,GAA2B,CAAzD,IAA8D,KAAKC,kBAAL,GAA0B,CAA/G;AACA,WAAKE,cAAL;AACD;;;oDAE+C;AAAA,UAArBC,iBAAqB,SAArBA,iBAAqB;;AAC9C,WAAKC,kBAAL,GAA0BD,iBAA1B;AACA,WAAKlC,OAAL;AACD;;;iDAEyC;AAAA,UAAlBoC,cAAkB,SAAlBA,cAAkB;;AACxC,WAAKC,eAAL,GAAuBD,cAAvB;AACA,WAAKpC,OAAL;AACD;;;2CAE2D;AAAA,UAA1CsC,SAA0C,SAA1CA,SAA0C;AAAA,UAA/BC,UAA+B,SAA/BA,UAA+B;AAAA,UAAnBC,eAAmB,SAAnBA,eAAmB;;AAC1D,UACEF,cAAc,KAAK1H,UAAnB,IACA2H,eAAe,KAAK5H,WADpB,IAEA6H,oBAAoB,KAAK3H,gBAH3B,EAIE;AACA,aAAKD,UAAL,GAAkB0H,SAAlB;AACA,aAAK3H,WAAL,GAAmB4H,UAAnB;AACA,aAAK1H,gBAAL,GAAwB2H,eAAxB;AACA,aAAKC,cAAL;AACD;AACF;;;yCAIE;AAAA,UAFDC,MAEC,SAFDA,MAEC;AAAA,gCADDC,OACC;AAAA,UADDA,OACC,iCADS,EACT;;AACD,WAAKC,OAAL,GAAeF,MAAf;AACA,WAAK1H,QAAL,GAAgB2H,OAAhB;AACA,WAAKE,aAAL;AACD;;;oCAEe;AACd,WAAKC,iBAAL;AACA,WAAKC,mBAAL;AACA,WAAKC,kBAAL;AACD;;;oCAIe;AACd,WAAKtJ,qBAAL,CAA2BuJ,IAA3B,CAAgC,IAAhC,EAAsC;AACpC/H,cAAM,KAAKrB,aAAL,CAAmBqJ,YADW;AAEpCC,kBAAU;AACR9J,sBAAY,KAAKD,WADT;AAERG,sBAAY,KAAKD,WAFT;AAGRL,yBAAe,KAAKD,cAHZ;AAIRG,yBAAe,KAAKD;AAJZ;AAF0B,OAAtC;AASD;;;+CAcE;AAAA,6BAZDyC,IAYC;AAAA,UAXC2F,KAWD,cAXCA,KAWD;AAAA,UAVCC,MAUD,cAVCA,MAUD;AAAA,UARD/F,SAQC,SARDA,SAQC;AAAA,UAPDH,MAOC,SAPDA,MAOC;AAAA,iCAND8H,QAMC;AAAA,UALC9J,UAKD,kBALCA,UAKD;AAAA,UALaE,UAKb,kBALaA,UAKb;AAAA,UALyBN,aAKzB,kBALyBA,aAKzB;AAAA,UALwCE,aAKxC,kBALwCA,aAKxC;AAAA,UAHDmJ,SAGC,SAHDA,SAGC;AAAA,UAFDC,UAEC,SAFDA,UAEC;AAAA,UADDC,eACC,SADDA,eACC;;AACD,WAAKzJ,UAAL,GAAkByC,SAAlB;AACA,WAAKjB,OAAL,GAAec,MAAf;AACA,UAAI,CAAC,KAAK1D,SAAV,EAAqB;AACnB,aAAKyB,WAAL,GAAmBC,UAAnB;AACA,aAAKC,WAAL,GAAmBC,UAAnB;AACA,aAAKP,cAAL,GAAsBC,aAAtB;AACA,aAAKC,cAAL,GAAsBC,aAAtB;AACD;AACD,WAAKkB,SAAL,GAAiBiH,KAAjB;AACA,WAAKhH,UAAL,GAAkBiH,MAAlB;AACA,WAAK3G,UAAL,GAAkB0H,SAAlB;AACA,WAAK3H,WAAL,GAAmB4H,UAAnB;AACA,WAAK1H,gBAAL,GAAwB2H,eAAxB;AACA,WAAK9H,QAAL,GAAgB,KAAhB;AACA,WAAKsF,OAAL;AACD;;;uCACkB;AACjB,aAAO,KAAK7F,iBAAL,KAA2B,OAA3B,GACL,CAAC,CADI,GAEL,CAFF;AAGD;;;qCACgB;AACf,UAAM5B,SAAS,KAAKC,gBAAL,EAAf;AACA,UAAI,KAAKO,UAAT,EAAqB;AACnB,aAAKgB,UAAL,CAAgBwG,YAAhB,CACE,OADF,6BAE2B,KAAKvH,cAAL,GAAsBT,MAFjD,YAE8D,CAAC,KAAK6B,QAFpE;AAID,OALD,MAKO;AACL,aAAKL,UAAL,CAAgBwG,YAAhB,CACE,OADF,6BAE2B,KAAKnH,WAAL,GAAmBb,MAF9C,YAE2D,KAAKe,WAFhE;AAID;AACF;;;gDAC2B;AAAA,kCAMtB,KAAK8J,wBAAL,EANsB;AAAA,UAExBhC,QAFwB,yBAExBA,QAFwB;AAAA,UAGxBC,QAHwB,yBAGxBA,QAHwB;AAAA,UAIxBP,QAJwB,yBAIxBA,QAJwB;AAAA,UAKxBG,QALwB,yBAKxBA,QALwB;;AAQ1B,UAAI,KAAKlI,UAAT,EAAqB;AACnB,YAAMsK,mBAAmBC,KAAKC,GAAL,CAASD,KAAKE,GAAL,CAAS,KAAKxK,cAAd,EAA8B8H,QAA9B,CAAT,EAAkDM,QAAlD,CAAzB;AACA,YAAIiC,qBAAqB,KAAKrK,cAA9B,EAA8C;AAC5C,eAAKA,cAAL,GAAsBqK,gBAAtB;AACD;AACD,YAAMI,mBAAmBH,KAAKC,GAAL,CAASD,KAAKE,GAAL,CAAS,KAAKtK,cAAd,EAA8B,CAACmI,QAA/B,CAAT,EAAmD,CAACJ,QAApD,CAAzB;AACA,YAAIwC,qBAAqB,KAAKvK,cAA9B,EAA8C;AAC5C,eAAKA,cAAL,GAAsBuK,gBAAtB;AACD;AACF,OATD,MASO;AACL,YAAMC,gBAAgBJ,KAAKC,GAAL,CAASD,KAAKE,GAAL,CAAS,KAAKpK,WAAd,EAA2B0H,QAA3B,CAAT,EAA+CM,QAA/C,CAAtB;AACA,YAAMuC,gBAAgBL,KAAKC,GAAL,CAASD,KAAKE,GAAL,CAAS,KAAKlK,WAAd,EAA2B,CAAC+H,QAA5B,CAAT,EAAgD,CAACJ,QAAjD,CAAtB;AACA,YAAI,KAAK7H,WAAL,KAAqBsK,aAArB,IAAsC,KAAKpK,WAAL,KAAqBqK,aAA/D,EAA8E;AAC5E,eAAKvK,WAAL,GAAmBsK,aAAnB;AACA,eAAKpK,WAAL,GAAmBqK,aAAnB;AACD;AACF;AACD,WAAKC,cAAL;AACD;;;wCACmB;AAClB,UAAI,KAAK7K,UAAT,EAAqB;AACnB,aAAKqF,wBAAL,CAA8BoD,KAA9B,CAAoCF,KAApC,GAA4C,CAA5C;AACA,aAAKlD,wBAAL,CAA8BoD,KAA9B,CAAoCD,MAApC,GAA6C,CAA7C;AACD,OAHD,MAGO;AACL,aAAKnD,wBAAL,CAA8BoD,KAA9B,CAAoCF,KAApC,GAA+C,KAAKjH,SAApD;AACA,aAAK+D,wBAAL,CAA8BoD,KAA9B,CAAoCD,MAApC,GAAgD,KAAKjH,UAArD;AACA,aAAKuE,eAAL,CAAqB2C,KAArB,CAA2BF,KAA3B,GAAsC,KAAKjH,SAA3C;AACA,aAAKwE,eAAL,CAAqB2C,KAArB,CAA2BD,MAA3B,GAAuC,KAAKjH,UAA5C;AACD;AACF;;;uCACkB;AACjB,WAAKP,UAAL,CAAgBwG,YAAhB,CAA6B,OAA7B,EAAsC,0BACpC,KAAKrG,OAAL,CAAa7C,IADuB,EAEpC,KAAK6C,OAAL,CAAa,KAAKC,iBAAlB,CAFoC,EAGpC,KAAKI,OAAL,IAAgB,KAAKL,OAAL,CAAamB,MAHO,EAIpC,KAAKtC,UAAL,IAAmB,KAAKmB,OAAL,CAAasB,SAJI,EAKpC,KAAK7D,SAAL,IAAkB,KAAKuC,OAAL,CAAa2J,QALK,EAMpC,KAAKrJ,MAAL,IAAe,KAAKN,OAAL,CAAa4J,KANQ,EAOpC,KAAKpJ,QAAL,IAAiB,KAAKR,OAAL,CAAa6J,OAPM,CAAtC;AASA,WAAK/F,SAAL,CAAeuC,YAAf,CAA4B,OAA5B,EAAqC,0BACnC,KAAKrG,OAAL,CAAa0C,MADsB,EAEnC,KAAK7D,UAAL,IAAmB,KAAKmB,OAAL,CAAasB,SAFG,EAGnC,KAAKkG,QAAL,IAAiB,KAAKxH,OAAL,CAAauH,OAHK,CAArC;AAKD;;;qCACgB;AACf,WAAK9C,WAAL,CAAiB4B,YAAjB,CAA8B,OAA9B,EAAuC,0BACrC,KAAKxH,UAAL,IAAmB,KAAKmB,OAAL,CAAasB,SADK,EAErC,KAAKtB,OAAL,CAAa2C,QAFwB,EAGrC,KAAKlC,WAAL,IAAoB,KAAKT,OAAL,CAAa,KAAKS,WAAlB,CAHiB,EAIrC,KAAKC,UAAL,IAAmB,KAAKV,OAAL,CAAa,KAAKU,UAAlB,CAJkB,CAAvC;AAMD;;;qCACgB;AACf,UAAMoJ,YAAY,KAAK1E,iBAAvB;AACA,aAAOgE,KAAKW,KAAL,CAAW,CAAE,IAAIhM,IAAJ,EAAD,CAAaiM,OAAb,KAAyBF,SAA1B,IAAuC,IAAlD,CAAP;AACD;;;qCACgB;AAAA;AAAA;;AACf;AACA,UAAI,KAAKG,cAAT,EAAyB;AACvBC,sBAAc,KAAKD,cAAnB;AACA,aAAKA,cAAL,GAAsB,IAAtB;AACD;AACD;AACA,UAAI,CAAC,KAAKnC,eAAV,EAA2B;AACzB,aAAKlH,YAAL,GAAoB,CAAC,CAArB;AACA,aAAK0E,WAAL,GAAmB,KAAnB;AACA,aAAKD,SAAL,GAAiB,KAAjB;AACA,YAAI,KAAK8E,gBAAT,EAA2B;AACzBD,wBAAc,KAAKC,gBAAnB;AACA,eAAKA,gBAAL,GAAwB,IAAxB;AACD;AACD,aAAK5E,eAAL;AACA;AACD;AACD;AACA,UACE,KAAKH,iBAAL,GAAyB,CAAzB,IACA,KAAKwC,mBAAL,KAA6B,CAD7B,IAEA,KAAKC,kBAAL,KAA4B,CAH9B,EAIE;AACA,aAAKjH,YAAL,GAAoBhE,YAApB;AACA,aAAK0I,WAAL,GAAmB,KAAnB;AACA,aAAK8E,mBAAL;AACA,aAAK7E,eAAL;AACA;AACD;AACD;AACA;AACA,UAAI,KAAKH,iBAAL,KAA2B,CAA3B,IAAgC,KAAKwC,mBAAL,GAA2B,CAA/D,EAAkE;AAChE,aAAKhH,YAAL,GAAoBjE,aAApB;AACA,aAAK2I,WAAL,GAAmB,KAAnB;AACA,aAAKD,SAAL,GAAiB,KAAjB;AACA,YAAI,KAAK8E,gBAAT,EAA2B;AACzBD,wBAAc,KAAKC,gBAAnB;AACA,eAAKA,gBAAL,GAAwB,IAAxB;AACD;AACD,aAAKtB,mBAAL;AACA,aAAKtD,eAAL;AACA;AACD;AACD,WAAK8E,WAAL,mEACGzN,YADH,EACkB,KAAKwI,iBAAL,GAAyB,CAD3C,+CAEGzI,aAFH,EAEmB,KAAKiL,mBAAL,GAA2B,CAF9C,+CAGGlL,aAHH,EAGmB,KAAKmL,kBAAL,GAA0B,CAH7C;AAKA;AACA,WAAKyC,cAAL;AACA,WAAKL,cAAL,GAAsBM,YAAY,YAAM;AACtC,eAAKD,cAAL;AACD,OAFqB,EAEnBxN,eAFmB,CAAtB;AAGD;;;qCAEgB;AACf,UAAI,KAAKuI,SAAL,IAAkB,KAAKgF,WAAL,CAAiB,KAAKzJ,YAAtB,CAAtB,EAA2D;AACzD;AACD;AACD,WAAK4J,SAAL,GAAiB,KAAK5J,YAAtB;AACA,WAAKA,YAAL,GAAoB,KAAK6J,SAAL,CAAe,KAAK7J,YAApB,CAApB;AACA,aAAO,CAAC,KAAKyJ,WAAL,CAAiB,KAAKzJ,YAAtB,CAAR,EAA6C;AAC3C,aAAKA,YAAL,GAAoB,KAAK6J,SAAL,CAAe,KAAK7J,YAApB,CAApB;AACD;AACD,cAAQ,KAAKA,YAAb;AACE,aAAKlE,aAAL;AACE,eAAKoM,kBAAL;AACA;AACF,aAAKnM,aAAL;AACE,eAAKkM,mBAAL;AACA;AACF,aAAKjM,YAAL;AACE,eAAKwN,mBAAL;AACA;AACF;AACE;AAXJ;AAaA,WAAK9E,WAAL,GAAmB,IAAnB;AACA,WAAKC,eAAL;AACA,WAAKD,WAAL,GAAmB,KAAnB;AACD;;;8BAESoF,K,EAAO;AACf,UAAMC,WAAWD,QAAQ,CAAzB;AACA,UAAIA,SAAS7N,gBAAgB,CAA7B,EAAgC;AAC9B,eAAO,CAAP;AACD;AACD,aAAO8N,QAAP;AACD;;;0CAEqB;AACpB,WAAK3G,OAAL,CAAaqC,YAAb,CAA0B,OAA1B,EAAmC,0BACjC,KAAKrG,OAAL,CAAaoD,IADoB,EAEjC,KAAKpD,OAAL,CAAa4K,IAFoB,EAGjC,KAAKzE,QAAL,IAAiB,KAAKA,QAAL,KAAkB,EAAnC,IAAyC,KAAKnG,OAAL,CAAasG,OAHrB,CAAnC;AAKA,WAAK1B,WAAL,CAAiByB,YAAjB,CAA8B,OAA9B,EAAuC,0BACrC,KAAKrG,OAAL,CAAaqD,QADwB,CAAvC;AAGA,WAAK4B,eAAL,CAAqBoB,YAArB,CAAkC,OAAlC,EAA2C,0BACzC,KAAKrG,OAAL,CAAasD,YAD4B,CAA3C;AAGA,WAAK4B,cAAL,CAAoBmB,YAApB,CAAiC,OAAjC,EAA0C,0BACxC,KAAKrG,OAAL,CAAauD,WAD2B,CAA1C;AAGA,WAAKuB,cAAL,CAAoBuB,YAApB,CAAiC,OAAjC,EAA0C,0BACxC,KAAKrG,OAAL,CAAawD,cAD2B,CAA1C;AAGA,WAAKuB,YAAL,CAAkBsB,YAAlB,CAA+B,OAA/B,EAAwC,0BACtC,KAAKrG,OAAL,CAAayD,YADyB,CAAxC;AAGD;;;sCAEiB;AAChB,UAAI,KAAK5E,UAAT,EAAqB;AACnB,aAAKgM,mBAAL;AACA;AACD;AACD,WAAK7G,OAAL,CAAaqC,YAAb,CAA0B,OAA1B,EAAmC,0BACjC,KAAKrG,OAAL,CAAaoD,IADoB,EAEjC,CAAC,KAAK0E,eAAN,IAAyB,KAAK3B,QAA9B,IAA0C,KAAKA,QAAL,KAAkB,EAA5D,IAAkE,KAAKnG,OAAL,CAAasG,OAF9C,CAAnC;AAIA,WAAK1B,WAAL,CAAiByB,YAAjB,CAA8B,OAA9B,EAAuC,0BACrC,KAAKrG,OAAL,CAAaqD,QADwB,EAErC,KAAKyH,YAAL,IAAqB,KAAK9K,OAAL,CAAasG,OAFG,EAGrC,KAAKyE,cAAL,IAAuB,KAAK/K,OAAL,CAAagL,MAHC,EAIrC,KAAKC,eAAL,IAAwB,KAAKjL,OAAL,CAAakL,OAJA,EAKrC,KAAKC,cAAL,IAAuB,KAAKnL,OAAL,CAAaoL,MALC,CAAvC;AAOA,WAAKnG,eAAL,CAAqBoB,YAArB,CAAkC,OAAlC,EAA2C,0BACzC,KAAKrG,OAAL,CAAasD,YAD4B,EAEzC,KAAK+H,gBAAL,IAAyB,KAAKrL,OAAL,CAAasG,OAFG,EAGzC,KAAKgF,cAAL,IAAuB,KAAKtL,OAAL,CAAagL,MAHK,EAIzC,KAAKO,kBAAL,IAA2B,KAAKvL,OAAL,CAAakL,OAJC,EAKzC,KAAKM,iBAAL,IAA0B,KAAKxL,OAAL,CAAaoL,MALE,CAA3C;AAOA,WAAKlG,cAAL,CAAoBmB,YAApB,CAAiC,OAAjC,EAA0C,0BACxC,KAAKrG,OAAL,CAAauD,WAD2B,EAExC,KAAKkI,eAAL,IAAwB,KAAKzL,OAAL,CAAasG,OAFG,EAGxC,KAAKgF,cAAL,IAAuB,KAAKtL,OAAL,CAAagL,MAHI,EAIxC,KAAKU,iBAAL,IAA0B,KAAK1L,OAAL,CAAakL,OAJC,EAKxC,KAAKS,gBAAL,IAAyB,KAAK3L,OAAL,CAAaoL,MALE,CAA1C;AAOA,WAAKtG,cAAL,CAAoBuB,YAApB,CAAiC,OAAjC,EAA0C,0BACxC,KAAKrG,OAAL,CAAawD,cAD2B,EAExC,KAAKoI,kBAAL,IAA2B,KAAK5L,OAAL,CAAasG,OAFA,EAGxC,KAAKuF,qBAAL,IAA8B,KAAK7L,OAAL,CAAakL,OAHH,EAIxC,KAAKY,oBAAL,IAA6B,KAAK9L,OAAL,CAAaoL,MAJF,CAA1C;AAMA,WAAKrG,YAAL,CAAkBsB,YAAlB,CAA+B,OAA/B,EAAwC,0BACtC,KAAKrG,OAAL,CAAayD,YADyB,EAEtC,KAAKsI,gBAAL,IAAyB,KAAK/L,OAAL,CAAasG,OAFA,EAGtC,CAAC,KAAK0F,kBAAN,IAA4B,KAAKC,mBAAjC,IAAwD,KAAKjM,OAAL,CAAakL,OAH/B,EAItC,KAAKc,kBAAL,IAA2B,KAAKhM,OAAL,CAAaoL,MAJF,CAAxC;AAMD;;;0CAEqB;AAAA;;AACpB,UAAI,KAAKjB,gBAAT,EAA2B;AACzBD,sBAAc,KAAKC,gBAAnB;AACA,aAAKA,gBAAL,GAAwB,IAAxB;AACD;AACD,UAAM9G,WAAW,8BAAe,KAAK6I,cAAL,EAAf,CAAjB;AACA,WAAKtH,WAAL,CAAiBhB,SAAjB,GAA6BP,QAA7B;AACA,WAAK8G,gBAAL,GAAwBI,YAAY,YAAM;AACxC,YAAMlH,WAAW,8BAAe,OAAK6I,cAAL,EAAf,CAAjB;AACA,eAAKtH,WAAL,CAAiBhB,SAAjB,GAA6BP,QAA7B;AACD,OAHuB,EAGrB,IAHqB,CAAxB;AAID;;;0CAEqB;AACpB,UAAI,CAAC,KAAKuE,mBAAN,IAA6B,CAAC,KAAK9G,QAAvC,EAAiD;AAC/C;AACD;AACD,WAAKmE,eAAL,CAAqBrB,SAArB,GAAiC,KAAK9C,QAAL,CAAcqL,aAA/C;AACA,WAAKlH,eAAL,CAAqBmH,KAArB,GAA6B,KAAKtL,QAAL,CAAcqL,aAA3C;AACD;;;yCAEoB;AACnB,UAAI,CAAC,KAAKtE,kBAAN,IAA4B,CAAC,KAAK/G,QAAtC,EAAgD;AAC9C;AACD;AACD,WAAKoE,cAAL,CAAoBtB,SAApB,GAAgC,KAAK9C,QAAL,CAAcuL,eAA9C;AACA,WAAKnH,cAAL,CAAoBkH,KAApB,GAA4B,KAAKtL,QAAL,CAAcuL,eAA1C;AACD;;;wCAEmB;AAClB,UAAI,CAAC,KAAKvL,QAAV,EAAoB;AAClB;AACD;AACD,WAAKgE,cAAL,CAAoBlB,SAApB,GAAgC,KAAK9C,QAAL,CAAc0C,cAA9C;AACA,WAAKuB,YAAL,CAAkBnB,SAAlB,GAA8B,KAAK9C,QAAL,CAAc2C,YAA5C;AACD;;;8BAGS;AACR,WAAK8E,cAAL;AACA,WAAK7B,iBAAL;AACA,WAAK7I,yBAAL;AACA,WAAKO,gBAAL;AACA,WAAKmH,eAAL;AACD;;;8BAES;AACR;AACAJ,aAAOmH,mBAAP,CAA2B,WAA3B,EAAwC,KAAKrO,kBAA7C;AACAkH,aAAOmH,mBAAP,CAA2B,QAA3B,EAAqC,KAAK9O,eAA1C;AACA,UAAI,KAAKE,cAAT,EAAyB;AACvBC,qBAAa,KAAKG,WAAlB;AACD;AACD,WAAK+B,UAAL,CAAgB0M,MAAhB;AACD;;;wBA5dsB;AACrB,aAAO,KAAKC,iBAAZ;AACD;;;wBA4de;AACd,aAAO,KAAK3M,UAAZ;AACD;;;wBACU;AACT,aAAO,KAAKE,KAAZ;AACD;;;wBACc;AACb,aAAO,KAAK+D,SAAZ;AACD;;;wBAC6B;AAC5B,aAAO,KAAKI,wBAAZ;AACD;;;wBACc;AACb,aAAO,KAAKC,SAAZ;AACD;;;wBACa;AACZ,aAAO,KAAKI,QAAZ;AACD;;;wBACgB;AACf,aAAO,KAAKE,WAAZ;AACD;;;wBACoB;AACnB,aAAO,KAAKE,eAAZ;AACD;;;wBACmB;AAClB,aAAO,KAAK7F,cAAZ;AACD;;;wBACmB;AAClB,aAAO,KAAKE,cAAZ;AACD;;;wBACgB;AACf,aAAO,KAAKE,WAAZ;AACD;;;wBACgB;AACf,aAAO,KAAKE,WAAZ;AACD;;;wBACc;AACb,aAAO,KAAKe,SAAZ;AACD;;;wBACe;AACd,aAAO,KAAKC,UAAZ;AACD;;;wBACuB;AACtB,aAAO,KAAK1B,kBAAZ;AACD;;;wBAEY;AACX,aAAO,KAAK2B,OAAZ;AACD;;;wBACe;AACd,aAAO,KAAKxB,UAAZ;AACD;;;wBACc;AACb,aAAO,KAAKpB,SAAZ;AACD;;;wBACW;AACV,aAAO,KAAK6C,MAAZ;AACD;;;wBACa;AACZ,aAAO,KAAKE,QAAZ;AACD;;;wBACgB;AACf,aAAO,KAAKC,WAAZ;AACD;;;wBACe;AACd,aAAO,KAAKC,UAAZ;AACD;;;wBACa;AACZ,aAAO,KAAK8G,QAAZ;AACD;;;wBAEkB;AACjB,aAAO,CAAC,KAAKlC,WAAN,IAAqB,KAAK1E,YAAL,KAAsBhE,YAAlD;AACD;;;wBAEsB;AACrB,aAAO,CAAC,KAAK0I,WAAN,IAAqB,KAAK1E,YAAL,KAAsBjE,aAAlD;AACD;;;wBAEqB;AACpB,aAAO,CAAC,KAAK2I,WAAN,IAAqB,KAAK1E,YAAL,KAAsBlE,aAAlD;AACD;;;wBAEwB;AACvB,aAAO,CAAC,KAAKuL,kBAAN,IAA4B,KAAK6C,YAAxC;AACD;;;wBAEsB;AACrB,aAAO,CAAC,KAAK3C,eAAN,KAA0B,KAAKsD,eAAL,IAAwB,KAAKJ,gBAAvD,CAAP;AACD;;;wBAEoB;AACnB,aAAO,KAAKpD,kBAAZ;AACD;;;wBAEoB;AACnB,aAAO,KAAKE,eAAZ;AACD;;;wBAEoB;AACnB,aAAO,CAAC,KAAK9C,SAAN,IAAmB,KAAKzE,YAAL,KAAsBhE,YAAzC,IAAyD,KAAK0I,WAArE;AACD;;;wBAEqB;AACpB,aAAO,CAAC,KAAKD,SAAN,IAAmB,KAAKC,WAAxB,IAAuC,KAAKkF,SAAL,KAAmB5N,YAAjE;AACD;;;wBAEuB;AACtB,aAAO,CAAC,KAAKyI,SAAN,IAAmB,KAAKzE,YAAL,KAAsBjE,aAAzC,IAA0D,KAAK2I,WAAtE;AACD;;;wBAEwB;AACvB,aAAO,CAAC,KAAKD,SAAN,IAAmB,KAAKC,WAAxB,IAAuC,KAAKkF,SAAL,KAAmB7N,aAAjE;AACD;;;wBAEsB;AACrB,aAAO,CAAC,KAAK0I,SAAN,IAAmB,KAAKzE,YAAL,KAAsBlE,aAAzC,IAA0D,KAAK4I,WAAtE;AACD;;;wBAEuB;AACtB,aAAO,CAAC,KAAKD,SAAN,IAAmB,KAAKC,WAAxB,IAAuC,KAAKkF,SAAL,KAAmB9N,aAAjE;AACD;;;wBAE0B;AACzB,aAAO,CAAC,KAAKuL,kBAAN,IAA4B,KAAKkD,cAAxC;AACD;;;wBAE2B;AAC1B,aAAO,CAAC,KAAKlD,kBAAN,IAA4B,KAAKgD,eAAxC;AACD;;;wBAEwB;AACvB,aAAO,CAAC,KAAK9C,eAAN,KAA0B,KAAKqD,iBAAL,IAA0B,KAAKG,gBAAzD,CAAP;AACD;;;wBAEyB;AACxB,aAAO,CAAC,KAAKxD,eAAN,KAA0B,KAAKoD,kBAAL,IAA2B,KAAKG,iBAA1D,CAAP;AACD;;;;;kBAp5BkB3O,W","file":"index.js","sourcesContent":["import classnames from 'classnames';\nimport { prefixEnum } from 'ringcentral-integration/lib/Enum';\nimport ensureExist from 'ringcentral-integration/lib/ensureExist';\nimport debounce from 'ringcentral-integration/lib/debounce';\nimport formatDuration from '../formatDuration';\nimport baseMessageTypes from './baseMessageTypes';\n\nconst SANDBOX_ATTRIBUTE_VALUE = [\n  'allow-same-origin',\n  'allow-scripts',\n  'allow-forms',\n  'allow-popups',\n].join(' ');\n\n// chrome 63 mandate the declaration of this attribute for getUserMedia to work in iframes\nconst ALLOW_ATTRIBUTE_VALUE = [\n  'microphone',\n  // 'camera',\n].join(' ');\n\nconst ON_HOLD_CALLS = 0;\nconst RINGING_CALLS = 1;\nconst CURRENT_CALL = 2;\n\n\nconst ROTATE_LENGTH = 3;\nconst ROTATE_INTERVAL = 5000;\n\nexport default class AdapterCore {\n  constructor({\n    prefix,\n    styles,\n    container,\n    root = container,\n    messageTypes = baseMessageTypes,\n    defaultDirection = 'left',\n    defaultPadding = 15,\n  }) {\n    this._prefix = prefix;\n    this._messageTypes = prefixEnum({ enumMap: messageTypes, prefix });\n    this._container = this:: ensureExist(container, 'container');\n    this._root = root;\n    this._styles = styles;\n    this._defaultDirection = defaultDirection;\n\n    this._padding = defaultPadding;\n    this._minTranslateX = 0;\n    this._minTranslateY = 0;\n    this._translateX = 0;\n    this._translateY = 0;\n    this._appWidth = 0;\n    this._appHeight = 0;\n    this._dragStartPosition = null;\n\n    this._closed = true;\n    this._minimized = true;\n    this._dragging = false;\n    this._hover = false;\n    this._hoverHeader = false;\n    this._loading = true;\n    this._userStatus = null;\n    this._dndStatus = null;\n    this._telephonyStatus = null;\n\n    this.currentState = -1;\n    this._scrollale = false;\n\n    this._strings = {};\n  }\n  _onMessage(msg) {\n    if (msg) {\n      switch (msg.type) {\n        case this._messageTypes.syncClosed:\n          this._onSyncClosed(msg.closed);\n          break;\n        case this._messageTypes.syncMinimized:\n          this._onSyncMinimized(msg.minimized);\n          break;\n        case this._messageTypes.syncSize:\n          this._onSyncSize(msg.size);\n          break;\n        case this._messageTypes.syncPresence:\n          this._onPushPresence(msg);\n          break;\n        case this._messageTypes.pushAdapterState:\n          this._onPushAdapterState(msg);\n          break;\n        case this._messageTypes.pushLocale:\n          this._onPushLocale(msg);\n          break;\n        case this._messageTypes.pushRingState:\n          this._onPushRingState(msg);\n          break;\n        case this._messageTypes.pushCalls:\n          this._onPushCallsInfo(msg);\n          break;\n        case this._messageTypes.pushOnCurrentCallPath:\n          this._onPushOnCurrentCallPath(msg);\n          break;\n        case this._messageTypes.pushOnAllCallsPath:\n          this._onPushOnAllCallsPath(msg);\n          break;\n        default:\n          break;\n      }\n    }\n  }\n\n  _getContentDOM(sanboxAttributeValue, allowAttributeValue) {\n    return `\n      <header class=\"${this._styles.header}\" draggable=\"false\">\n        <div class=\"${this._styles.presence} ${this._styles.NoPresence}\">\n          <div class=\"${this._styles.presenceBar}\">\n          </div>\n        </div>\n        <div class=\"${this._styles.button} ${this._styles.toggle}\">\n          <div class=\"${this._styles.minimizeIcon}\">\n            <div class=\"${this._styles.minimizeIconBar}\"></div>\n          </div>\n        </div>\n        <div class=\"${this._styles.button} ${this._styles.close}\">\n          <div class=\"${this._styles.closeIcon}\">\n            <div></div><div></div>\n          </div>\n        </div>\n        <img class=\"${this._styles.logo}\" draggable=\"false\"></img>\n        <div class=\"${this._styles.duration}\"></div>\n        <div class=\"${this._styles.ringingCalls}\"></div>\n        <div class=\"${this._styles.onHoldCalls}\"></div>\n        <div class=\"${this._styles.currentCallBtn}\">${this._strings.currentCallBtn}</div>\n        <div class=\"${this._styles.viewCallsBtn}\">${this._strings.viewCallsBtn}</div>\n      </header>\n      <div class=\"${this._styles.frameContainer}\">\n        <iframe class=\"${this._styles.contentFrame}\" sandbox=\"${sanboxAttributeValue}\" allow=\"${allowAttributeValue}\" >\n        </iframe>\n      </div>`;\n  }\n\n  _generateContentDOM() {\n    this._root.innerHTML = this._getContentDOM(SANDBOX_ATTRIBUTE_VALUE, ALLOW_ATTRIBUTE_VALUE);\n    this._headerEl = this._root.querySelector(\n      `.${this._styles.header}`\n    );\n    this._logoEl = this._root.querySelector(\n      `.${this._styles.logo}`\n    );\n    this._logoEl.addEventListener('dragstart', () => false);\n\n    this._contentFrameContainerEl = this._root.querySelector(\n      `.${this._styles.frameContainer}`\n    );\n\n    // toggle button\n    this._toggleEl = this._root.querySelector(\n      `.${this._styles.toggle}`\n    );\n    this._toggleEl.addEventListener('click', (evt) => {\n      evt.stopPropagation();\n      this.toggleMinimized();\n    });\n\n    // close button\n    this._closeEl = this._root.querySelector(\n      `.${this._styles.close}`\n    );\n\n    if (this._closeEl) {\n      this._closeEl.addEventListener('click', () => {\n        this.setClosed(true);\n      });\n    }\n\n    this._presenceEl = this._root.querySelector(\n      `.${this._styles.presence}`\n    );\n    this._presenceEl.addEventListener('click', (evt) => {\n      evt.stopPropagation();\n      this._postMessage({\n        type: this._messageTypes.presenceClicked,\n      });\n    });\n    this._contentFrameEl = this._root.querySelector(\n      `.${this._styles.contentFrame}`\n    );\n\n    this._durationEl = this._root.querySelector(\n      `.${this._styles.duration}`\n    );\n\n    this._durationEl.addEventListener('click', (evt) => {\n      evt.stopPropagation();\n      this._postMessage({\n        type: this._messageTypes.navigateToCurrentCall,\n      });\n    });\n\n    this._currentCallEl = this._root.querySelector(\n      `.${this._styles.currentCallBtn}`\n    );\n    this._currentCallEl.addEventListener('click', (evt) => {\n      evt.stopPropagation();\n      this._postMessage({\n        type: this._messageTypes.navigateToCurrentCall,\n      });\n    });\n\n    this._viewCallsEl = this._root.querySelector(\n      `.${this._styles.viewCallsBtn}`\n    );\n    this._viewCallsEl.addEventListener('click', (evt) => {\n      evt.stopPropagation();\n      this._postMessage({\n        type: this._messageTypes.navigateToViewCalls,\n      });\n    });\n\n    this._ringingCallsEl = this._root.querySelector(\n      `.${this._styles.ringingCalls}`\n    );\n\n    this._onHoldCallsEl = this._root.querySelector(\n      `.${this._styles.onHoldCalls}`\n    );\n\n    this._headerEl.addEventListener('mousedown', (e) => {\n      this._dragging = true;\n      this._isClick = true;\n      this._dragStartPosition = {\n        x: e.clientX,\n        y: e.clientY,\n        translateX: this._translateX,\n        translateY: this._translateY,\n        minTranslateX: this._minTranslateX,\n        minTranslateY: this._minTranslateY,\n      };\n      this._renderMainClass();\n    });\n    this._headerEl.addEventListener('mouseup', () => {\n      this._dragging = false;\n      this._renderMainClass();\n    });\n    window.addEventListener('mousemove', this._onWindowMouseMove);\n\n    this._headerEl.addEventListener('mouseenter', () => {\n      if (!this._minimized) {\n        if (this._currentStartTime > 0) {\n          this._hoverBar = true;\n          this._scrollable = false;\n          this._renderCallsBar();\n        }\n        return;\n      }\n      this._hoverHeader = true;\n      this._renderMainClass();\n    });\n    this._headerEl.addEventListener('mouseleave', () => {\n      this._hoverHeader = false;\n      this._hoverBar = false;\n      this._scrollable = false;\n      this._renderCallsBar();\n      this._renderMainClass();\n    });\n\n    this._isClick = true;\n    this._headerEl.addEventListener('click', (evt) => {\n      if (!this._isClick) return;\n      this._onHeaderClicked(evt);\n    });\n\n    this._resizeTimeout = null;\n    this._resizeTick = null;\n    window.addEventListener('resize', this._onWindowResize);\n\n    // hover detection for ie\n    this._container.addEventListener('mouseenter', () => {\n      this._hover = true;\n      this._renderMainClass();\n    });\n    this._container.addEventListener('mouseleave', () => {\n      this._hover = false;\n      this._renderMainClass();\n    });\n    if (document.readyState === 'loading') {\n      window.addEventListener('load', () => {\n        document.body.appendChild(this._container);\n      });\n    } else {\n      document.body.appendChild(this._container);\n    }\n\n    if (typeof this._beforeRender === 'function') {\n      this._beforeRender();\n    }\n    this._render();\n  }\n  _onWindowResize = () => {\n    if (this._dragging) { return; }\n    if (this._resizeTimeout) { clearTimeout(this._resizeTimeout); }\n    this._resizeTimeout = setTimeout(() => this._renderRestrictedPosition(), 100);\n    if (!this._resizeTick || Date.now() - this._resizeTick > 50) {\n      this._resizeTick = Date.now();\n      this._renderRestrictedPosition();\n    }\n  }\n  _onWindowMouseMove = (e) => {\n    if (this._dragging) {\n      if (e.buttons === 0) {\n        this._dragging = false;\n        this._renderMainClass();\n        return;\n      }\n      const factor = this._calculateFactor();\n      const delta = {\n        x: e.clientX - this._dragStartPosition.x,\n        y: e.clientY - this._dragStartPosition.y,\n      };\n      if (this._minimized) {\n        this._minTranslateX = this._dragStartPosition.minTranslateX + delta.x * factor;\n        this._minTranslateY = this._dragStartPosition.minTranslateY + delta.y;\n      } else {\n        this._translateX = this._dragStartPosition.translateX + delta.x * factor;\n        this._translateY = this._dragStartPosition.translateY + delta.y;\n      }\n      if (delta.x !== 0 || delta.y !== 0) this._isClick = false;\n      this._syncPosition();\n      this._renderRestrictedPosition();\n    }\n  }\n\n  get messageTransport() {\n    return this._messageTransport;\n  }\n\n  _postMessage(data) {\n    this.messageTransport.postMessage(data);\n  }\n\n  _setLogoUrl(logoUrl) {\n    this._logoUrl = logoUrl;\n    this._logoEl.src = logoUrl;\n    this._logoEl.setAttribute('class', classnames(\n      this._styles.logo,\n      this._logoUrl && this._logoUrl !== '' && this._styles.visible,\n    ));\n  }\n\n  _setAppUrl(appUrl) {\n    this._appUrl = appUrl;\n    if (appUrl) {\n      this.contentFrameEl.src = appUrl;\n    }\n  }\n\n  _onSyncMinimized(minimized) {\n    this._minimized = !!minimized;\n    this._renderMainClass();\n    this.renderAdapterSize();\n    this._renderRestrictedPosition();\n  }\n  setMinimized(minimized) {\n    this._onSyncMinimized(minimized);\n    this._postMessage({\n      type: this._messageTypes.syncMinimized,\n      minimized: this._minimized,\n    });\n  }\n  toggleMinimized() {\n    this.setMinimized(!this._minimized);\n  }\n\n  _calculateMinMaxPosition() {\n    const maximumX = window.innerWidth -\n      (this._minimized ? this._headerEl.clientWidth : this._appWidth) - 2 * this._padding;\n    const maximumY = window.innerHeight -\n      (this._minimized ?\n        this._headerEl.clientHeight :\n        this._headerEl.clientHeight + this._appHeight) - this._padding;\n    return {\n      minimumX: this._padding,\n      minimumY: this._padding,\n      maximumX,\n      maximumY,\n    };\n  }\n\n  _onSyncClosed(closed) {\n    this._closed = !!closed;\n    this._renderMainClass();\n  }\n  setClosed(closed) {\n    this._onSyncClosed(closed);\n    this._postMessage({\n      type: this._messageTypes.syncClosed,\n      closed: this.closed,\n    });\n  }\n  toggleClosed() {\n    this.setClosed(!this.closed);\n  }\n\n  _onSyncSize({ width, height }) {\n    this._appWidth = width;\n    this._appHeight = height;\n    this._contentFrameEl.style.width = `${width}px`;\n    this._contentFrameEl.style.height = `${height}px`;\n    this.renderAdapterSize();\n  }\n  setSize(size) {\n    this._onSyncSize(size);\n    this._postMessage({\n      type: this._messageTypes.syncSize,\n      size,\n    });\n  }\n\n  _onPushRingState({ ringing }) {\n    this._ringing = ringing;\n    this._render();\n  }\n\n  _onPushCallsInfo({ ringingCallsLength, onHoldCallsLength, currentStartTime }) {\n    this._currentStartTime = currentStartTime;\n    this._ringingCallsLength = ringingCallsLength;\n    this._onHoldCallsLength = onHoldCallsLength;\n    this._hasActiveCalls = this._currentStartTime > 0 || this._ringingCallsLength > 0 || this._onHoldCallsLength > 0;\n    this.renderCallsBar();\n  }\n\n  _onPushOnCurrentCallPath({ onCurrentCallPath }) {\n    this._onCurrentCallPath = onCurrentCallPath;\n    this._render();\n  }\n\n  _onPushOnAllCallsPath({ onAllCallsPath }) {\n    this._onAllCallsPath = onAllCallsPath;\n    this._render();\n  }\n\n  _onPushPresence({ dndStatus, userStatus, telephonyStatus }) {\n    if (\n      dndStatus !== this._dndStatus ||\n      userStatus !== this._userStatus ||\n      telephonyStatus !== this._telephonyStatus\n    ) {\n      this._dndStatus = dndStatus;\n      this._userStatus = userStatus;\n      this._telephonyStatus = telephonyStatus;\n      this.renderPresence();\n    }\n  }\n  _onPushLocale({\n    locale,\n    strings = {},\n  }) {\n    this._locale = locale;\n    this._strings = strings;\n    this._renderString();\n  }\n\n  _renderString() {\n    this._renderCallBarBtn();\n    this._renderRingingCalls();\n    this._renderOnHoldCalls();\n  }\n\n  _debouncedPostMessage = debounce(this._postMessage, 100)\n\n  _syncPosition() {\n    this._debouncedPostMessage.call(this, {\n      type: this._messageTypes.syncPosition,\n      position: {\n        translateX: this._translateX,\n        translateY: this._translateY,\n        minTranslateX: this._minTranslateX,\n        minTranslateY: this._minTranslateY,\n      },\n    });\n  }\n  _onPushAdapterState({\n    size: {\n      width,\n      height\n    },\n    minimized,\n    closed,\n    position: {\n      translateX, translateY, minTranslateX, minTranslateY\n    },\n    dndStatus,\n    userStatus,\n    telephonyStatus,\n  }) {\n    this._minimized = minimized;\n    this._closed = closed;\n    if (!this._dragging) {\n      this._translateX = translateX;\n      this._translateY = translateY;\n      this._minTranslateX = minTranslateX;\n      this._minTranslateY = minTranslateY;\n    }\n    this._appWidth = width;\n    this._appHeight = height;\n    this._dndStatus = dndStatus;\n    this._userStatus = userStatus;\n    this._telephonyStatus = telephonyStatus;\n    this._loading = false;\n    this._render();\n  }\n  _calculateFactor() {\n    return this._defaultDirection === 'right' ?\n      -1 :\n      1;\n  }\n  renderPosition() {\n    const factor = this._calculateFactor();\n    if (this._minimized) {\n      this._container.setAttribute(\n        'style',\n        `transform: translate( ${this._minTranslateX * factor}px, ${-this._padding}px)!important;`\n      );\n    } else {\n      this._container.setAttribute(\n        'style',\n        `transform: translate( ${this._translateX * factor}px, ${this._translateY}px)!important;`\n      );\n    }\n  }\n  _renderRestrictedPosition() {\n    const {\n      minimumX,\n      minimumY,\n      maximumX,\n      maximumY,\n    } = this._calculateMinMaxPosition();\n\n    if (this._minimized) {\n      const newMinTranslateX = Math.max(Math.min(this._minTranslateX, maximumX), minimumX);\n      if (newMinTranslateX !== this._minTranslateX) {\n        this._minTranslateX = newMinTranslateX;\n      }\n      const newMinTranslateY = Math.max(Math.min(this._minTranslateY, -minimumY), -maximumY);\n      if (newMinTranslateY !== this._minTranslateY) {\n        this._minTranslateY = newMinTranslateY;\n      }\n    } else {\n      const newTranslateX = Math.max(Math.min(this._translateX, maximumX), minimumX);\n      const newTranslateY = Math.max(Math.min(this._translateY, -minimumY), -maximumY);\n      if (this._translateX !== newTranslateX || this._translateY !== newTranslateY) {\n        this._translateX = newTranslateX;\n        this._translateY = newTranslateY;\n      }\n    }\n    this.renderPosition();\n  }\n  renderAdapterSize() {\n    if (this._minimized) {\n      this._contentFrameContainerEl.style.width = 0;\n      this._contentFrameContainerEl.style.height = 0;\n    } else {\n      this._contentFrameContainerEl.style.width = `${this._appWidth}px`;\n      this._contentFrameContainerEl.style.height = `${this._appHeight}px`;\n      this._contentFrameEl.style.width = `${this._appWidth}px`;\n      this._contentFrameEl.style.height = `${this._appHeight}px`;\n    }\n  }\n  _renderMainClass() {\n    this._container.setAttribute('class', classnames(\n      this._styles.root,\n      this._styles[this._defaultDirection],\n      this._closed && this._styles.closed,\n      this._minimized && this._styles.minimized,\n      this._dragging && this._styles.dragging,\n      this._hover && this._styles.hover,\n      this._loading && this._styles.loading,\n    ));\n    this._headerEl.setAttribute('class', classnames(\n      this._styles.header,\n      this._minimized && this._styles.minimized,\n      this._ringing && this._styles.ringing,\n    ));\n  }\n  renderPresence() {\n    this._presenceEl.setAttribute('class', classnames(\n      this._minimized && this._styles.minimized,\n      this._styles.presence,\n      this._userStatus && this._styles[this._userStatus],\n      this._dndStatus && this._styles[this._dndStatus],\n    ));\n  }\n  calculateState() {\n    const startTime = this._currentStartTime;\n    return Math.round(((new Date()).getTime() - startTime) / 1000);\n  }\n  renderCallsBar() {\n    // should clean up rotate duration when call info changed\n    if (this.rotateInterval) {\n      clearInterval(this.rotateInterval);\n      this.rotateInterval = null;\n    }\n    // when there is no call\n    if (!this._hasActiveCalls) {\n      this.currentState = -1;\n      this._scrollable = false;\n      this._hoverBar = false;\n      if (this.durationInterval) {\n        clearInterval(this.durationInterval);\n        this.durationInterval = null;\n      }\n      this._renderCallsBar();\n      return;\n    }\n    // when there is only one active call, only need to display call duration\n    if (\n      this._currentStartTime > 0 &&\n      this._ringingCallsLength === 0 &&\n      this._onHoldCallsLength === 0\n    ) {\n      this.currentState = CURRENT_CALL;\n      this._scrollable = false;\n      this._renderCallDuration();\n      this._renderCallsBar();\n      return;\n    }\n    // when there are only ringing calls(no onhold or active calls)\n    // only need to display incoming call inco\n    if (this._currentStartTime === 0 && this._ringingCallsLength > 0) {\n      this.currentState = RINGING_CALLS;\n      this._scrollable = false;\n      this._hoverBar = false;\n      if (this.durationInterval) {\n        clearInterval(this.durationInterval);\n        this.durationInterval = null;\n      }\n      this._renderRingingCalls();\n      this._renderCallsBar();\n      return;\n    }\n    this.callInfoMap = {\n      [CURRENT_CALL]: this._currentStartTime > 0,\n      [RINGING_CALLS]: this._ringingCallsLength > 0,\n      [ON_HOLD_CALLS]: this._onHoldCallsLength > 0\n    };\n    // when multiple calls, should scroll with call info\n    this.rotateCallInfo();\n    this.rotateInterval = setInterval(() => {\n      this.rotateCallInfo();\n    }, ROTATE_INTERVAL);\n  }\n\n  rotateCallInfo() {\n    if (this._hoverBar && this.callInfoMap[this.currentState]) {\n      return;\n    }\n    this.lastState = this.currentState;\n    this.currentState = this.increment(this.currentState);\n    while (!this.callInfoMap[this.currentState]) {\n      this.currentState = this.increment(this.currentState);\n    }\n    switch (this.currentState) {\n      case ON_HOLD_CALLS:\n        this._renderOnHoldCalls();\n        break;\n      case RINGING_CALLS:\n        this._renderRingingCalls();\n        break;\n      case CURRENT_CALL:\n        this._renderCallDuration();\n        break;\n      default:\n        break;\n    }\n    this._scrollable = true;\n    this._renderCallsBar();\n    this._scrollable = false;\n  }\n\n  increment(state) {\n    const newState = state + 1;\n    if (state >= ROTATE_LENGTH - 1) {\n      return 0;\n    }\n    return newState;\n  }\n\n  _renderMinimizedBar() {\n    this._logoEl.setAttribute('class', classnames(\n      this._styles.logo,\n      this._styles.dock,\n      this._logoUrl && this._logoUrl !== '' && this._styles.visible,\n    ));\n    this._durationEl.setAttribute('class', classnames(\n      this._styles.duration,\n    ));\n    this._ringingCallsEl.setAttribute('class', classnames(\n      this._styles.ringingCalls,\n    ));\n    this._onHoldCallsEl.setAttribute('class', classnames(\n      this._styles.onHoldCalls,\n    ));\n    this._currentCallEl.setAttribute('class', classnames(\n      this._styles.currentCallBtn,\n    ));\n    this._viewCallsEl.setAttribute('class', classnames(\n      this._styles.viewCallsBtn,\n    ));\n  }\n\n  _renderCallsBar() {\n    if (this._minimized) {\n      this._renderMinimizedBar();\n      return;\n    }\n    this._logoEl.setAttribute('class', classnames(\n      this._styles.logo,\n      !this._hasActiveCalls && this._logoUrl && this._logoUrl !== '' && this._styles.visible,\n    ));\n    this._durationEl.setAttribute('class', classnames(\n      this._styles.duration,\n      this.showDuration && this._styles.visible,\n      this.centerDuration && this._styles.center,\n      this.moveOutDuration && this._styles.moveOut,\n      this.moveInDuration && this._styles.moveIn,\n    ));\n    this._ringingCallsEl.setAttribute('class', classnames(\n      this._styles.ringingCalls,\n      this.showRingingCalls && this._styles.visible,\n      this.centerCallInfo && this._styles.center,\n      this.moveOutRingingInfo && this._styles.moveOut,\n      this.moveInRingingInfo && this._styles.moveIn,\n    ));\n    this._onHoldCallsEl.setAttribute('class', classnames(\n      this._styles.onHoldCalls,\n      this.showOnHoldCalls && this._styles.visible,\n      this.centerCallInfo && this._styles.center,\n      this.moveOutOnHoldInfo && this._styles.moveOut,\n      this.moveInOnHoldInfo && this._styles.moveIn,\n    ));\n    this._currentCallEl.setAttribute('class', classnames(\n      this._styles.currentCallBtn,\n      this.showCurrentCallBtn && this._styles.visible,\n      this.moveOutCurrentCallBtn && this._styles.moveOut,\n      this.moveInCurrentCallBtn && this._styles.moveIn,\n    ));\n    this._viewCallsEl.setAttribute('class', classnames(\n      this._styles.viewCallsBtn,\n      this.showViewCallsBtn && this._styles.visible,\n      !this.moveInViewCallsBtn && this.moveOutViewCallsBtn && this._styles.moveOut,\n      this.moveInViewCallsBtn && this._styles.moveIn,\n    ));\n  }\n\n  _renderCallDuration() {\n    if (this.durationInterval) {\n      clearInterval(this.durationInterval);\n      this.durationInterval = null;\n    }\n    const duration = formatDuration(this.calculateState());\n    this._durationEl.innerHTML = duration;\n    this.durationInterval = setInterval(() => {\n      const duration = formatDuration(this.calculateState());\n      this._durationEl.innerHTML = duration;\n    }, 1000);\n  }\n\n  _renderRingingCalls() {\n    if (!this._ringingCallsLength || !this._strings) {\n      return;\n    }\n    this._ringingCallsEl.innerHTML = this._strings.ringCallsInfo;\n    this._ringingCallsEl.title = this._strings.ringCallsInfo;\n  }\n\n  _renderOnHoldCalls() {\n    if (!this._onHoldCallsLength || !this._strings) {\n      return;\n    }\n    this._onHoldCallsEl.innerHTML = this._strings.onHoldCallsInfo;\n    this._onHoldCallsEl.title = this._strings.onHoldCallsInfo;\n  }\n\n  _renderCallBarBtn() {\n    if (!this._strings) {\n      return;\n    }\n    this._currentCallEl.innerHTML = this._strings.currentCallBtn;\n    this._viewCallsEl.innerHTML = this._strings.viewCallsBtn;\n  }\n\n\n  _render() {\n    this.renderPresence();\n    this.renderAdapterSize();\n    this._renderRestrictedPosition();\n    this._renderMainClass();\n    this._renderCallsBar();\n  }\n\n  dispose() {\n    // TODO clean up\n    window.removeEventListener('mousemove', this._onWindowMouseMove);\n    window.removeEventListener('resize', this._onWindowResize);\n    if (this._resizeTimeout) {\n      clearTimeout(this._resizeTick);\n    }\n    this._container.remove();\n  }\n\n  get container() {\n    return this._container;\n  }\n  get root() {\n    return this._root;\n  }\n  get headerEl() {\n    return this._headerEl;\n  }\n  get contentFrameContainerEl() {\n    return this._contentFrameContainerEl;\n  }\n  get toggleEl() {\n    return this._toggleEl;\n  }\n  get closeEl() {\n    return this._closeEl;\n  }\n  get presenceEl() {\n    return this._presenceEl;\n  }\n  get contentFrameEl() {\n    return this._contentFrameEl;\n  }\n  get minTranslateX() {\n    return this._minTranslateX;\n  }\n  get minTranslateY() {\n    return this._minTranslateY;\n  }\n  get translateX() {\n    return this._translateX;\n  }\n  get translateY() {\n    return this._translateY;\n  }\n  get appWidth() {\n    return this._appWidth;\n  }\n  get appHeight() {\n    return this._appHeight;\n  }\n  get dragStartPosition() {\n    return this._dragStartPosition;\n  }\n\n  get closed() {\n    return this._closed;\n  }\n  get minimized() {\n    return this._minimized;\n  }\n  get dragging() {\n    return this._dragging;\n  }\n  get hover() {\n    return this._hover;\n  }\n  get loading() {\n    return this._loading;\n  }\n  get userStatus() {\n    return this._userStatus;\n  }\n  get dndStatus() {\n    return this._dndStatus;\n  }\n  get ringing() {\n    return this._ringing;\n  }\n\n  get showDuration() {\n    return !this._scrollable && this.currentState === CURRENT_CALL;\n  }\n\n  get showRingingCalls() {\n    return !this._scrollable && this.currentState === RINGING_CALLS;\n  }\n\n  get showOnHoldCalls() {\n    return !this._scrollable && this.currentState === ON_HOLD_CALLS;\n  }\n\n  get showCurrentCallBtn() {\n    return !this._onCurrentCallPath && this.showDuration;\n  }\n\n  get showViewCallsBtn() {\n    return !this._onAllCallsPath && (this.showOnHoldCalls || this.showRingingCalls);\n  }\n\n  get centerDuration() {\n    return this._onCurrentCallPath;\n  }\n\n  get centerCallInfo() {\n    return this._onAllCallsPath;\n  }\n\n  get moveInDuration() {\n    return !this._hoverBar && this.currentState === CURRENT_CALL && this._scrollable;\n  }\n\n  get moveOutDuration() {\n    return !this._hoverBar && this._scrollable && this.lastState === CURRENT_CALL;\n  }\n\n  get moveInRingingInfo() {\n    return !this._hoverBar && this.currentState === RINGING_CALLS && this._scrollable;\n  }\n\n  get moveOutRingingInfo() {\n    return !this._hoverBar && this._scrollable && this.lastState === RINGING_CALLS;\n  }\n\n  get moveInOnHoldInfo() {\n    return !this._hoverBar && this.currentState === ON_HOLD_CALLS && this._scrollable;\n  }\n\n  get moveOutOnHoldInfo() {\n    return !this._hoverBar && this._scrollable && this.lastState === ON_HOLD_CALLS;\n  }\n\n  get moveInCurrentCallBtn() {\n    return !this._onCurrentCallPath && this.moveInDuration;\n  }\n\n  get moveOutCurrentCallBtn() {\n    return !this._onCurrentCallPath && this.moveOutDuration;\n  }\n\n  get moveInViewCallsBtn() {\n    return !this._onAllCallsPath && (this.moveInRingingInfo || this.moveInOnHoldInfo);\n  }\n\n  get moveOutViewCallsBtn() {\n    return !this._onAllCallsPath && (this.moveOutRingingInfo || this.moveOutOnHoldInfo);\n  }\n}\n"]}