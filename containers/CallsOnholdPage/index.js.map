{"version":3,"sources":["containers/CallsOnholdPage/index.js"],"names":["CallsOnholdContainer","props","getCalls","calls","fromSessionId","call","webphoneSession","direction","callDirections","inbound","isConferenceSession","id","Component","propTypes","PropTypes","arrayOf","object","isRequired","string","func","mapToProps","_","phone","callMonitor","params","baseProps","mapToFunctions","webphone","conferenceCall","routerInteraction","getAvatarUrl","onMerge","sessionId","mergeSession","sessionIdToMergeWith","onReadyToMerge","confId","conferences","push","goBack","onBackButtonClick","sessions","length","go","onAdd","fromNumber","CallsOnholdPage"],"mappings":"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","file":"index.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport callDirections from 'ringcentral-integration/enums/callDirections';\nimport { createSelector } from 'reselect';\nimport { filter } from 'ramda';\n\nimport withPhone from '../../lib/withPhone';\nimport CallsOnholdPanel from '../../components/CallsOnholdPanel';\n\nimport {\n  mapToProps as mapToBaseProps,\n  mapToFunctions as mapToBaseFunctions,\n} from '../ActiveCallsPage';\n\n\nclass CallsOnholdContainer extends Component {\n  static propTypes = {\n    calls: PropTypes.arrayOf(PropTypes.object).isRequired,\n    fromSessionId: PropTypes.string.isRequired,\n    isConferenceSession: PropTypes.func.isRequired,\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.getCalls = createSelector(\n      () => this.props.calls,\n      () => this.props.fromSessionId,\n      (calls, fromSessionId) => filter(\n        call => (\n          call.webphoneSession &&\n          call.direction !== callDirections.inbound\n          && !this.props.isConferenceSession(call.webphoneSession)\n          && call.webphoneSession.id !== fromSessionId\n        ),\n        calls\n      ),\n    );\n  }\n\n  render() {\n    return <CallsOnholdPanel {...this.props} calls={this.getCalls()} />;\n  }\n}\n\nfunction mapToProps(_, {\n  phone,\n  phone: {\n    callMonitor,\n  },\n  params,\n  ...props\n}) {\n  const { fromSessionId } = params;\n  const baseProps = mapToBaseProps(_, {\n    phone,\n    ...props,\n  });\n\n  return {\n    ...baseProps,\n    calls: callMonitor.calls,\n    fromSessionId,\n  };\n}\n\nfunction mapToFunctions(_, {\n  params,\n  phone,\n  phone: {\n    webphone,\n    conferenceCall,\n    routerInteraction,\n  },\n  getAvatarUrl,\n  ...props\n}) {\n  const { fromSessionId } = params;\n\n  const baseProps = mapToBaseFunctions(_, {\n    params,\n    phone,\n    ...props,\n  });\n  return {\n    ...baseProps,\n    async onMerge(sessionId) {\n      await conferenceCall.mergeSession({\n        sessionId,\n        sessionIdToMergeWith: fromSessionId,\n        onReadyToMerge() {\n          const confId = conferenceCall.conferences && Object.keys(conferenceCall.conferences)[0];\n\n          if (confId) {\n            const sessionId = conferenceCall.conferences[confId].sessionId;\n\n            routerInteraction.push(`/calls/active/${sessionId}`);\n          } else {\n            routerInteraction.goBack();\n          }\n        },\n\n      });\n    },\n    onBackButtonClick() {\n      if (webphone.sessions.length) {\n        routerInteraction.goBack();\n        return;\n      }\n      phone.routerInteraction.go(-2);\n    },\n    onAdd() {\n      routerInteraction.push(`/conferenceCall/dialer/${params.fromNumber}/${params.fromSessionId}`);\n    },\n    getAvatarUrl,\n    isConferenceSession: (...args) => conferenceCall.isConferenceSession(...args),\n  };\n}\n\nconst CallsOnholdPage = withPhone(connect(\n  mapToProps,\n  mapToFunctions,\n)(CallsOnholdContainer));\n\nexport default CallsOnholdPage;\n"]}