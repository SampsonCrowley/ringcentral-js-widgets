{"version":3,"sources":["containers/ContactDetailsPage/index.js"],"names":["mapToProps","_","params","phone","locale","contactDetails","contactSearch","rolesAndPermissions","auth","audioSettings","webphone","callingSettings","currentLocale","contactItem","contact","disableCallButton","ready","loggedIn","isWebphoneMode","userMedia","connected","showSpinner","outboundSmsPermission","permissions","OutboundSMS","internalSmsPermission","InternalSMS","mapToFunctions","dialerRoute","composeTextRoute","routerInteraction","regionSettings","call","dialerUI","composeText","getContact","find","id","contactId","type","contactType","clearContact","clear","formatNumber","phoneNumber","cleanedNumber","toString","isE164Number","formatedNumber","countryCode","beFormated","getAvatar","getProfileImage","getPresence","onBackClick","goBack","onClickToDial","callingEnabled","recipient","isIdle","push","onClickToCall","undefined","onClickToSMS","isDummyContact","name","updateTypingToNumber","search","searchString","addToNumber","typingToNumber","cleanTypingToNumber","ContactDetailsPage","ContactDetailsView"],"mappings":"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","sourcesContent":["import { connect } from 'react-redux';\nimport { isE164, parseIncompletePhoneNumber } from '@ringcentral-integration/phone-number';\nimport formatNumber from 'ringcentral-integration/lib/formatNumber';\nimport ContactDetailsView from '../../components/ContactDetailsView';\nimport { withPhone } from '../../lib/phoneContext';\n\nfunction mapToProps(_, {\n  params,\n  phone: {\n    locale,\n    contactDetails,\n    contactSearch,\n    rolesAndPermissions,\n    auth,\n    audioSettings,\n    webphone,\n    callingSettings,\n  },\n}) {\n  return {\n    currentLocale: locale.currentLocale,\n    contactItem: contactDetails.contact,\n    disableCallButton:\n      auth.ready &&\n      audioSettings.ready &&\n      webphone && webphone.ready &&\n      auth.loggedIn &&\n      (callingSettings.isWebphoneMode &&\n        (!audioSettings.userMedia || !webphone.connected)\n      ),\n    showSpinner: !(\n      locale.ready &&\n      contactSearch.ready &&\n      contactDetails.ready &&\n      rolesAndPermissions.ready\n    ),\n    outboundSmsPermission: !!(\n      rolesAndPermissions.permissions &&\n      rolesAndPermissions.permissions.OutboundSMS\n    ),\n    internalSmsPermission: !!(\n      rolesAndPermissions.permissions &&\n      rolesAndPermissions.permissions.InternalSMS\n    ),\n  };\n}\n\nfunction mapToFunctions(_, {\n  params,\n  dialerRoute = '/dialer',\n  composeTextRoute = '/composeText',\n  phone: {\n    routerInteraction,\n    contactDetails,\n    regionSettings,\n    call,\n    dialerUI,\n    composeText,\n    contactSearch,\n    rolesAndPermissions\n  },\n}) {\n  return {\n    getContact() {\n      contactDetails.find({\n        id: params.contactId,\n        type: params.contactType\n      });\n    },\n    clearContact() {\n      contactDetails.clear();\n    },\n    formatNumber(phoneNumber) {\n      // if the cleaned phone number is not a E164 format, we will show it directly, doesn't format it.\n      const cleanedNumber = parseIncompletePhoneNumber(phoneNumber.toString());\n      const isE164Number = isE164(cleanedNumber);\n      if (isE164Number) {\n        const formatedNumber = formatNumber({\n          phoneNumber,\n          countryCode: regionSettings.countryCode,\n        });\n        return { phoneNumber: formatedNumber, beFormated: true };\n      }\n      return { phoneNumber, beFormated: false };\n    },\n    getAvatar: contact => contactDetails.getProfileImage(contact),\n    getPresence: contact => contactDetails.getPresence(contact),\n    onBackClick() {\n      routerInteraction.goBack();\n    },\n    onClickToDial: dialerUI && rolesAndPermissions.callingEnabled ?\n      (recipient) => {\n        if (call.isIdle) {\n          routerInteraction.push(dialerRoute);\n          dialerUI.call({ recipient });\n          contactDetails.onClickToCall();\n        }\n      } :\n      undefined,\n    onClickToSMS: composeText ?\n      async (contact, isDummyContact = false) => {\n        if (routerInteraction) {\n          routerInteraction.push(composeTextRoute);\n        }\n        // if contact autocomplete, if no match fill the number only\n        if (contact.name && contact.phoneNumber && isDummyContact) {\n          composeText.updateTypingToNumber(contact.name);\n          contactSearch.search({ searchString: contact.name });\n        } else {\n          composeText.addToNumber(contact);\n          if (composeText.typingToNumber === contact.phoneNumber) {\n            composeText.cleanTypingToNumber();\n          }\n        }\n        // for track\n        contactDetails.onClickToSMS();\n      } :\n      undefined,\n  };\n}\n\nconst ContactDetailsPage = withPhone(connect(mapToProps, mapToFunctions)(ContactDetailsView));\n\nexport default ContactDetailsPage;\n"],"file":"index.js"}