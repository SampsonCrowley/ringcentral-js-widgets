{"version":3,"sources":["components/ForwardForm/index.js"],"names":["cleanRegex","ForwardNumbers","numbers","onSelect","selected","formatPhone","styles","map","number","index","id","active","label","colon","phoneNumber","propTypes","PropTypes","array","isRequired","func","ForwardForm","props","_onCustomValueChange","value","setState","customValue","_clearToNumber","_setRecipient","recipient","_clearRecipient","state","selectedIndex","handling","filter","replace","onChange","getValue","onForward","result","_mounted","onCancel","onSelectCustomNumber","forwardingNumbers","length","setTimeout","customInput","focus","forwardingNumber","className","currentLocale","searchContact","searchContactList","phoneTypeRenderer","phoneSourceNameRenderer","autoFocus","disableButton","root","custromNumber","customLabel","i18n","getString","ref","buttonGroup","cancelButton","forwardButton","disabled","buttonText","Component","string","bool","defaultProps","undefined"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport isBlank from 'ringcentral-integration/lib/isBlank';\nimport RecipientsInput from '../RecipientsInput';\n\nimport Button from '../Button';\n\nimport styles from './styles.scss';\nimport i18n from './i18n';\n\nconst cleanRegex = /[^\\d+*-\\s]/g;\n\nfunction ForwardNumbers({\n  numbers,\n  onSelect,\n  selected,\n  formatPhone,\n}) {\n  return (\n    <div className={styles.numbers}>\n      {\n        numbers.map((number, index) => (\n          <div\n            key={number.id}\n            className={\n              classnames(styles.number, (index === selected ? styles.active : null))\n            }\n            onClick={() => onSelect(index)}\n          >\n            <span className={styles.label} title={number.label}>{number.label}</span>\n            <span className={styles.colon}>:</span>\n            <span >{formatPhone(number.phoneNumber)}</span>\n          </div>\n        ))\n      }\n    </div>\n  );\n}\n\nForwardNumbers.propTypes = {\n  numbers: PropTypes.array.isRequired,\n  onSelect: PropTypes.func.isRequired,\n  selected: PropTypes.number.isRequired,\n  formatPhone: PropTypes.func.isRequired,\n};\n\nexport default class ForwardForm extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      selectedIndex: 0,\n      customValue: '',\n      handling: false,\n      recipient: null,\n    };\n\n    this.filter = value => value.replace(cleanRegex, '');\n\n    this.onSelect = (index) => {\n      this.setState({\n        selectedIndex: index,\n      });\n      if (typeof this.props.onChange === 'function') {\n        this.props.onChange(this.getValue());\n      }\n    };\n\n    this.onForward = async () => {\n      this.setState({\n        handling: true,\n      });\n      const result = await this.props.onForward(this.getValue());\n      if (!this._mounted) {\n        return;\n      }\n      this.setState({\n        handling: false,\n      });\n      if (result) {\n        this.props.onCancel();\n      }\n    };\n\n    this.onSelectCustomNumber = () => {\n      this.onSelect(this.props.forwardingNumbers.length);\n      setTimeout(() => {\n        if (this.customInput) {\n          this.customInput.focus();\n        }\n      }, 100);\n    };\n  }\n\n  componentDidMount() {\n    this._mounted = true;\n  }\n\n  componentWillUnmount() {\n    this._mounted = false;\n  }\n\n  getValue() {\n    if (this.state.selectedIndex < this.props.forwardingNumbers.length) {\n      const forwardingNumber = this.props.forwardingNumbers[this.state.selectedIndex];\n      return (\n        forwardingNumber && forwardingNumber.phoneNumber\n      );\n    }\n    if (this.state.recipient) {\n      return this.state.recipient.phoneNumber;\n    }\n    return this.state.customValue;\n  }\n\n  _onCustomValueChange = (value) => {\n    this.setState({\n      customValue: value\n    });\n  }\n\n  _clearToNumber = () => {\n    this.setState({\n      customValue: ''\n    });\n  }\n\n  _setRecipient = (recipient) => {\n    this.setState({\n      recipient\n    });\n    this._clearToNumber();\n  }\n\n  _clearRecipient = () => {\n    this.setState({\n      recipient: null\n    });\n  }\n\n  render() {\n    const {\n      className,\n      onCancel,\n      currentLocale,\n      forwardingNumbers,\n      formatPhone,\n      searchContact,\n      searchContactList,\n      phoneTypeRenderer,\n      phoneSourceNameRenderer,\n      autoFocus,\n    } = this.props;\n    const value = this.getValue();\n    const disableButton = isBlank(value) || this.state.handling;\n    return (\n      <div className={classnames(styles.root, className)}>\n        <ForwardNumbers\n          formatPhone={formatPhone}\n          numbers={forwardingNumbers}\n          onSelect={this.onSelect}\n          selected={this.state.selectedIndex}\n        />\n        <div\n          className={\n            classnames(\n              styles.custromNumber,\n              this.state.selectedIndex === forwardingNumbers.length ? styles.active : null\n            )\n          }\n          onClick={this.onSelectCustomNumber}\n        >\n          <div className={styles.customLabel}>\n            {i18n.getString('customNumber', currentLocale)}\n          </div>\n          <RecipientsInput\n            label=\"\"\n            placeholder=\"\"\n            inputRef={(ref) => { this.customInput = ref; }}\n            value={this.state.customValue}\n            className={styles.customInput}\n            onChange={this._onCustomValueChange}\n            onClean={this._clearToNumber}\n            recipient={this.state.recipient}\n            addToRecipients={this._setRecipient}\n            removeFromRecipients={this._clearRecipient}\n            searchContact={searchContact}\n            searchContactList={searchContactList}\n            phoneTypeRenderer={phoneTypeRenderer}\n            phoneSourceNameRenderer={phoneSourceNameRenderer}\n            formatContactPhone={formatPhone}\n            currentLocale={currentLocale}\n            titleEnabled\n            autoFocus={autoFocus}\n          />\n        </div>\n        <div className={styles.buttonGroup}>\n          <Button\n            className={styles.cancelButton}\n            onClick={onCancel}\n          >\n            {i18n.getString('cancel', currentLocale)}\n          </Button>\n          <Button\n            className={\n              classnames(styles.forwardButton, disableButton ? styles.disabled : null)\n            }\n            onClick={this.onForward}\n            disabled={disableButton}\n          >\n            <span className={styles.buttonText}>\n              {i18n.getString('forward', currentLocale)}\n            </span>\n          </Button>\n        </div>\n      </div>\n    );\n  }\n}\n\nForwardForm.propTypes = {\n  className: PropTypes.string,\n  onCancel: PropTypes.func.isRequired,\n  currentLocale: PropTypes.string.isRequired,\n  forwardingNumbers: PropTypes.array.isRequired,\n  formatPhone: PropTypes.func.isRequired,\n  onForward: PropTypes.func.isRequired,\n  onChange: PropTypes.func,\n  searchContactList: PropTypes.array.isRequired,\n  searchContact: PropTypes.func.isRequired,\n  phoneTypeRenderer: PropTypes.func,\n  phoneSourceNameRenderer: PropTypes.func,\n  autoFocus: PropTypes.bool,\n};\n\nForwardForm.defaultProps = {\n  className: null,\n  onChange: undefined,\n  phoneTypeRenderer: undefined,\n  phoneSourceNameRenderer: undefined,\n  autoFocus: true,\n};\n"],"file":"index.js"}