{"version":3,"sources":["modules/ExtensionDevice/index.js"],"names":["ExtensionDevice","deps","dep","optional","client","options","name","fetchFunction","params","account","extension","device","list","map","cleanOnReset","addSelector","data","devices","phoneLines","forEach","length","concat","_selectors","DataFetcher"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IASqBA,e;AAPrB;;;;OAIC,gBAAO;AACNC,EAAAA,IAAI,EAAE,CAAC,QAAD,EAAW;AAAEC,IAAAA,GAAG,EAAE,wBAAP;AAAiCC,IAAAA,QAAQ,EAAE;AAA3C,GAAX;AADA,CAAP,C;;;;;AAIC;;;;;AAKA,iCAGG;AAAA;;AAAA,QAFDC,MAEC,QAFDA,MAEC;AAAA,QADEC,OACF;;AAAA;;AACD;AACEC,MAAAA,IAAI,EAAE,iBADR;AAEEF,MAAAA,MAAM,EAANA,MAFF;AAGEG,MAAAA,aAAa;AAAA;AAAA;AAAA,gCAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAAmB,wBAAU,UAAAC,MAAM;AAAA,2BAChDJ,MAAM,CAACK,OAAP,GAAiBC,SAAjB,GAA6BC,MAA7B,GAAsCC,IAAtC,CAA2CJ,MAA3C,CADgD;AAAA,mBAAhB,CAAnB;;AAAA;AAAA,gCAEP,UAAAG,MAAM;AAAA,6CACT,wBAAUA,MAAV,CADS;AAEZD,sBAAAA,SAAS,EAAE,wBAAUC,MAAM,CAACD,SAAjB;AAFC;AAAA,mBAFC;;AAAA,iEAEXG,GAFW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,SAHf;AASEC,MAAAA,YAAY,EAAE;AAThB,OAUKT,OAVL;;AAaA,UAAKU,WAAL,CACE,SADF,EAEE;AAAA,aAAM,MAAKC,IAAX;AAAA,KAFF,EAGE,UAAAA,IAAI;AAAA,aAAIA,IAAI,IAAI,EAAZ;AAAA,KAHN;;AAMA,UAAKD,WAAL,CACE,YADF,EAEE;AAAA,aAAM,MAAKE,OAAX;AAAA,KAFF,EAGE,UAACA,OAAD,EAAa;AACX,UAAIC,UAAU,GAAG,EAAjB;AACAD,MAAAA,OAAO,CAACE,OAAR,CAAgB,UAACR,MAAD,EAAY;AAC1B,YAAI,CAACA,MAAM,CAACO,UAAR,IAAsBP,MAAM,CAACO,UAAP,CAAkBE,MAAlB,KAA6B,CAAvD,EAA0D;AACxD;AACD;;AACDF,QAAAA,UAAU,GAAGA,UAAU,CAACG,MAAX,CAAkBV,MAAM,CAACO,UAAzB,CAAb;AACD,OALD;AAMA,aAAOA,UAAP;AACD,KAZH;;AApBC;AAkCF;;;;wBAEa;AACZ,aAAO,KAAKI,UAAL,CAAgBL,OAAhB,EAAP;AACD;;;wBAEgB;AACf,aAAO,KAAKK,UAAL,CAAgBJ,UAAhB,EAAP;AACD;;;;EAnD0CK,qB","sourcesContent":["import 'core-js/fn/array/find';\nimport { Module } from '../../lib/di';\nimport fetchList from '../../lib/fetchList';\nimport DataFetcher from '../../lib/DataFetcher';\nimport removeUri from '../../lib/removeUri';\n\n/**\n * @class\n * @description Extension device list module\n */\n@Module({\n  deps: ['Client', { dep: 'ExtensionDeviceOptions', optional: true }]\n})\nexport default class ExtensionDevice extends DataFetcher {\n  /**\n   * @constructor\n   * @param {Object} params - params object\n   * @param {Client} params.client - client module instance\n   */\n  constructor({\n    client,\n    ...options\n  }) {\n    super({\n      name: 'extensionDevice',\n      client,\n      fetchFunction: async () => (await fetchList(params => (\n        client.account().extension().device().list(params)\n      ))).map(device => ({\n        ...removeUri(device),\n        extension: removeUri(device.extension),\n      })),\n      cleanOnReset: true,\n      ...options,\n    });\n\n    this.addSelector(\n      'devices',\n      () => this.data,\n      data => data || [],\n    );\n\n    this.addSelector(\n      'phoneLines',\n      () => this.devices,\n      (devices) => {\n        let phoneLines = [];\n        devices.forEach((device) => {\n          if (!device.phoneLines || device.phoneLines.length === 0) {\n            return;\n          }\n          phoneLines = phoneLines.concat(device.phoneLines);\n        });\n        return phoneLines;\n      },\n    );\n  }\n\n  get devices() {\n    return this._selectors.devices();\n  }\n\n  get phoneLines() {\n    return this._selectors.phoneLines();\n  }\n}\n"],"file":"index.js"}